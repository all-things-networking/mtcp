Application configuration:
URL: /3.txt
# of total_flows: 100
# of cores: 1
Concurrency: 2
start of dpdk config
new dpdk
RTE_MAX_ETHPORTS = 32
here1: 1new dpdk num devices 1
byte1:228
passed the check: ens2
Initializing port 0... done: 
nb_rx_queues: 1, nb_tx_queues: 1
Port 0, MAC address: E4:1D:2D:13:9E:C0


Checking link statusdone
Port 0 Link Up - speed 40000 Mbps - full-duplex
main loop
CONFIG.eth_nums = 1
iomodule: dev_ioctl(DEV_NAME): net_mlx4
Created stream with saddr: 100665098, daddr: 83887882, sport: 260, dport: 20480
Created stream with saddr: 100665098, daddr: 83887882, sport: 516, dport: 20480
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928827/0
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928827/0
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20554, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 4268293770/2331928827
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec9194a
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20298, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 4268293770/2331928827
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec9100a
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 0 at state TCP_ST_LISTEN
In EPOLLIN
Stream 1 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 0 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
****************************
Stream 1 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928828/4268293770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928828/4268293770
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928828/4268293770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928828/4268293770
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 56181, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4268293770/2331928828
Payload Length: 0
Payload Data Pointer: 0x17ec906c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928828/4268293770
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 55925, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4268293770/2331928828
Payload Length: 0
Payload Data Pointer: 0x17ec8fd82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928828/4268293770
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 45429, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4268293770/2331928828
Payload Length: 0
Payload Data Pointer: 0x17ec8f442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 44917, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928828
Payload Length: 0
Payload Data Pointer: 0x17ec8eb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38711, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928828
Payload Length: 1448
Payload Data Pointer: 0x17ec8e1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12996, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928828
Payload Length: 1448
Payload Data Pointer: 0x17ec8d882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44888, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928828
Payload Length: 24
Payload Data Pointer: 0x17ec8cf42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4268293770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1020, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928829
Payload Length: 1448
Payload Data Pointer: 0x17ec8c602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32506, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928829
Payload Length: 1448
Payload Data Pointer: 0x17ec8bcc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39440, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928829
Payload Length: 1448
Payload Data Pointer: 0x17ec8b382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5116, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928829
Payload Length: 904
Payload Data Pointer: 0x17ec8aa42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36850, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4285070986/2331928829
Payload Length: 24
Payload Data Pointer: 0x17ec8a102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928829/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37431, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928828
Payload Length: 1448
Payload Data Pointer: 0x17ec897c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11716, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928828
Payload Length: 1448
Payload Data Pointer: 0x17ec88e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43608, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928828
Payload Length: 24
Payload Data Pointer: 0x17ec88542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8123, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928829
Payload Length: 142
Payload Data Pointer: 0x17ec87c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6997, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928829
Payload Length: 0
Payload Data Pointer: 0x17ec872c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 0: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 772, dport: 20480
Stream 0, port: 1025, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/4285070986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1025, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928833/0
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7680, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 1448
Payload Data Pointer: 0x17ec86982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14614, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 1448
Payload Data Pointer: 0x17ec86042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10517, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 12
Payload Data Pointer: 0x17ec85702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1460
my calculated merged len: 1460, recv_next: 5829, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 4368
data_avail: 1460
MTP Receive Chain returned: 1460
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61522, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 1448
Payload Data Pointer: 0x17ec84dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 584, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 1058
Payload Data Pointer: 0x17ec84482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5717, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec83b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 1: TCP_ST_CLOSE_WAIT
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5973, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec83202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5973, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec828c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1025, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5973, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 57278090/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec81f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17226, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 57278090/2331928833
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec8164a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 1028, dport: 20480
Stream 2 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 2 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
Stream 1, port: 1026, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1026, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928833/57278090
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928833/0
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5461, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 74055306/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec80d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5461, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 74055306/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec803c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1026, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5461, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 74055306/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec7fa82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 52853, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 74055306/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec7f142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16714, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 74055306/2331928833
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec7e80a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 3 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 3 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928835/74055306
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928835/74055306
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928835/74055306
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 41845, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90832522/2331928833
Payload Length: 0
Payload Data Pointer: 0x17ec7dec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 51829, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90832522/2331928835
Payload Length: 0
Payload Data Pointer: 0x17ec7d582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928835/90832522
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 41077, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90832522/2331928835
Payload Length: 0
Payload Data Pointer: 0x17ec7cc42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34103, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928835
Payload Length: 1448
Payload Data Pointer: 0x17ec7c302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/90832522
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8388, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928835
Payload Length: 1448
Payload Data Pointer: 0x17ec7b9c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40280, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928835
Payload Length: 24
Payload Data Pointer: 0x17ec7b082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33847, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928835
Payload Length: 1448
Payload Data Pointer: 0x17ec7a742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8132, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928835
Payload Length: 1448
Payload Data Pointer: 0x17ec79e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40024, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928835
Payload Length: 24
Payload Data Pointer: 0x17ec794c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/90832522
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4864, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 1448
Payload Data Pointer: 0x17ec78b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 5272
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4368
my calculated merged len: 4368, recv_next: 4369, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 29, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11798, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 1448
Payload Data Pointer: 0x17ec78242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 3824
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5816
my calculated merged len: 5816, recv_next: 5817, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7701, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 12
Payload Data Pointer: 0x17ec77902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 2376
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5828
my calculated merged len: 5828, recv_next: 5829, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 18, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 18, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58706, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 1448
Payload Data Pointer: 0x17ec76fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 2364
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 7276
my calculated merged len: 7276, recv_next: 7277, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 7, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47173, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 892
Payload Data Pointer: 0x17ec76682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 892, last_rcvd_seq: 8169, ctx->rwnd_size: 916
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 8168
my calculated merged len: 8168, recv_next: 8169, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2901, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 0
Payload Data Pointer: 0x17ec75d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61179, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 1448
Payload Data Pointer: 0x17ec75402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 5272
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4368
my calculated merged len: 4368, recv_next: 4369, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27130, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 1448
Payload Data Pointer: 0x17ec74ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 3824
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5816
my calculated merged len: 5816, recv_next: 5817, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34064, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 1448
Payload Data Pointer: 0x17ec74182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 2376
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 7264
my calculated merged len: 7264, recv_next: 7265, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65275, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 141164170/2331928838
Payload Length: 904
Payload Data Pointer: 0x17ec73842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 928
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 8168
my calculated merged len: 8168, recv_next: 8169, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 0, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 0, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 29, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 18, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 7, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 0, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928838/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34743, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 157941386/2331928838
Payload Length: 4
Payload Data Pointer: 0x17ec72f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 4, last_rcvd_seq: 8173, ctx->rwnd_size: 24
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 8172
my calculated merged len: 8172, recv_next: 8173, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 8173
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 0, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928839/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8173, cur_stream->mtp->last_flushed: 0
data_avail: 8172
MTP Receive Chain returned: 8172
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 0
data_avail: 8168
MTP Receive Chain returned: 8168
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 8173
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/157941386
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 8173, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4854, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174718602/2331928840
Payload Length: 162
Payload Data Pointer: 0x17ec725c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8173, ev_payloadlen: 162, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 162
my calculated merged len: 162, recv_next: 8335, last_flushed: 8172
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30450, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174718602/2331928840
Payload Length: 24
Payload Data Pointer: 0x17ec71c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8172
data_avail: 163
MTP Receive Chain returned: 163
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 1284, dport: 20480
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
Stream 2, port: 1027, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/157941386
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1027, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/174718602
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/141164170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928840/0
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1877, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174718602/2331928840
Payload Length: 0
Payload Data Pointer: 0x17ec71342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1027, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1877, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174718602/2331928840
Payload Length: 0
Payload Data Pointer: 0x17ec70a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13130, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 174718602/2331928840
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec700ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 4 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 4 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/174718602
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/174718602
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 49013, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174718602/2331928840
Payload Length: 0
Payload Data Pointer: 0x17ec6f782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928840/174718602
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 38261, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174718602/2331928840
Payload Length: 0
Payload Data Pointer: 0x17ec6ee42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1723, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928840
Payload Length: 142
Payload Data Pointer: 0x17ec6e502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 597, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928840
Payload Length: 0
Payload Data Pointer: 0x17ec6dbc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 3: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 1540, dport: 20480
Stream 3, port: 1028, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/174718602
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1028, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928844/0
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30775, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928840
Payload Length: 1448
Payload Data Pointer: 0x17ec6d282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5060, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928840
Payload Length: 1448
Payload Data Pointer: 0x17ec6c942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36952, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928840
Payload Length: 24
Payload Data Pointer: 0x17ec6c002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/174718602
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65108, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 0
Payload Data Pointer: 0x17ec6b6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65108, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 0
Payload Data Pointer: 0x17ec6ad82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1028, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65108, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 0
Payload Data Pointer: 0x17ec6a442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10826, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 241827466/2331928844
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec69b0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 5 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 5 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64450, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 1448
Payload Data Pointer: 0x17ec691c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1919, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 1448
Payload Data Pointer: 0x17ec68882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30736, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 1448
Payload Data Pointer: 0x17ec67f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61947, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 904
Payload Data Pointer: 0x17ec67602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64852, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 0
Payload Data Pointer: 0x17ec66cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928844/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 46709, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 0
Payload Data Pointer: 0x17ec66382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/241827466
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58199, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 166
Payload Data Pointer: 0x17ec65a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 1796, dport: 20480
Stream 4, port: 1029, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1029, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928845/57278090
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 35957, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928844
Payload Length: 0
Payload Data Pointer: 0x17ec65102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29239, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec647c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3524, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec63e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35416, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 241827466/2331928845
Payload Length: 24
Payload Data Pointer: 0x17ec63542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64340, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec62c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1029, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64340, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec622c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10058, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 258604682/2331928845
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec6198a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 6 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 6 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50459, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec61042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/241827466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45858, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec60702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29968, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec5fdc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40724, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 880
Payload Data Pointer: 0x17ec5f482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64084, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec5eb42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8145
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2365, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 24
Payload Data Pointer: 0x17ec5e202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 45941, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec5d8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57431, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 166
Payload Data Pointer: 0x17ec5cf82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 2052, dport: 20480
Stream 5, port: 1030, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1030, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928845/74055306
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64084, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec5c642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1030, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64084, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec5bd02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 35189, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec5b3c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28727, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec5aa82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3012, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec5a142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34904, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 24
Payload Data Pointer: 0x17ec59802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9802, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 258604682/2331928845
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec58eca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
Stream 7 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 7 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928845/258604682
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63426, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec58582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 895, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec57c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29712, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 1448
Payload Data Pointer: 0x17ec57302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60923, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 904
Payload Data Pointer: 0x17ec569c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 45685, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258604682/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec56082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63572, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275381898/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec55742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/258604682
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/275381898
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/258604682
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56663, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275381898/2331928846
Payload Length: 166
Payload Data Pointer: 0x17ec54e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 2308, dport: 20480
Stream 6, port: 1031, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/275381898
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1031, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928846/275381898
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928846/174718602
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 34677, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275381898/2331928845
Payload Length: 0
Payload Data Pointer: 0x17ec544c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63316, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275381898/2331928846
Payload Length: 0
Payload Data Pointer: 0x17ec53b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1031, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63316, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275381898/2331928846
Payload Length: 0
Payload Data Pointer: 0x17ec53242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9034, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 275381898/2331928846
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ec5290a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 8 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 8 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928847/275381898
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928847/275381898
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 44405, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 292159114/2331928847
Payload Length: 0
Payload Data Pointer: 0x17ec51fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928847/292159114
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 33653, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 292159114/2331928847
Payload Length: 0
Payload Data Pointer: 0x17ec51682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26935, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928846
Payload Length: 1448
Payload Data Pointer: 0x17ec50d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/275381898
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1220, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928846
Payload Length: 1448
Payload Data Pointer: 0x17ec50402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33112, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928846
Payload Length: 24
Payload Data Pointer: 0x17ec4fac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26423, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928847
Payload Length: 1448
Payload Data Pointer: 0x17ec4f182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 708, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928847
Payload Length: 1448
Payload Data Pointer: 0x17ec4e842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32600, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928847
Payload Length: 24
Payload Data Pointer: 0x17ec4df02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/292159114
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62975, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 1448
Payload Data Pointer: 0x17ec4d5c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4374, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 1448
Payload Data Pointer: 0x17ec4cc82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 277, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 12
Payload Data Pointer: 0x17ec4c342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1460
my calculated merged len: 1460, recv_next: 5829, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 4368
data_avail: 1460
MTP Receive Chain returned: 1460
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928850/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51282, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 1448
Payload Data Pointer: 0x17ec4ba02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55879, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 1058
Payload Data Pointer: 0x17ec4b0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61012, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 0
Payload Data Pointer: 0x17ec4a782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 7: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 2564, dport: 20480
Stream 7, port: 1032, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1032, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928851/241827466
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53755, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 1448
Payload Data Pointer: 0x17ec49e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19706, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 1448
Payload Data Pointer: 0x17ec49502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26640, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 1448
Payload Data Pointer: 0x17ec48bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57851, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342490762/2331928850
Payload Length: 904
Payload Data Pointer: 0x17ec48282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928851/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60500, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359267978/2331928851
Payload Length: 0
Payload Data Pointer: 0x17f3d15c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60500, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359267978/2331928851
Payload Length: 0
Payload Data Pointer: 0x17f3d1f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1032, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60500, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359267978/2331928851
Payload Length: 0
Payload Data Pointer: 0x17f507d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6218, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 359267978/2331928851
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f5098ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23538, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 359267978/2331928851
Window Scale: 7
Payload Length: 24
Payload Data Pointer: 0x17fc9ad82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
Stream 9 at state TCP_ST_LISTEN
In EPOLLIN
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
****************************
Stream 9 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928852/359267978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928852/359267978
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928852/342490762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 41845, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359267978/2331928852
Payload Length: 0
Payload Data Pointer: 0x17fd57e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928852/359267978
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 31093, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359267978/2331928852
Payload Length: 0
Payload Data Pointer: 0x17fd590c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60090, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928852
Payload Length: 142
Payload Data Pointer: 0x17fd59a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58964, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928852
Payload Length: 0
Payload Data Pointer: 0x17fd5a342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 8: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 2820, dport: 20480
Stream 8, port: 1033, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/359267978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1033, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928855/258604682
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23607, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928852
Payload Length: 1448
Payload Data Pointer: 0x17fdabb82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63427, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928852
Payload Length: 1448
Payload Data Pointer: 0x17fdad742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29784, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928852
Payload Length: 24
Payload Data Pointer: 0x17fdae082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/359267978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58196, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 0
Payload Data Pointer: 0x17fdae9c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58196, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 0
Payload Data Pointer: 0x17fdb1802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1033, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58196, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 0
Payload Data Pointer: 0x17ed324c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3914, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 426376842/2331928855
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ed3408a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 10 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 10 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57538, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 1448
Payload Data Pointer: 0x17ed349c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60542, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 1448
Payload Data Pointer: 0x17ed35302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23824, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 1448
Payload Data Pointer: 0x17ed35c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55035, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 904
Payload Data Pointer: 0x17f19a382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57940, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 0
Payload Data Pointer: 0x17f19bf42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928855/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 39797, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 426376842/2331928855
Payload Length: 0
Payload Data Pointer: 0x17f19c882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928856/426376842
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51031, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443154058/2331928855
Payload Length: 166
Payload Data Pointer: 0x17f19ed82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 3076, dport: 20480
Stream 9, port: 1034, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928856/426376842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1034, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928856/443154058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928856/258604682
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 28789, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443154058/2331928855
Payload Length: 0
Payload Data Pointer: 0x17f19f6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57428, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443154058/2331928856
Payload Length: 0
Payload Data Pointer: 0x17f1a0002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1034, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57428, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443154058/2331928856
Payload Length: 0
Payload Data Pointer: 0x17f1a0942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3146, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 443154058/2331928856
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f1a128a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 11 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 11 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928856/443154058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928856/443154058
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 39029, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443154058/2331928856
Payload Length: 0
Payload Data Pointer: 0x17f1a1bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928857/443154058
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 28277, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443154058/2331928856
Payload Length: 0
Payload Data Pointer: 0x17f1a2502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21047, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928856
Payload Length: 1448
Payload Data Pointer: 0x17fd41582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/443154058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60867, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928856
Payload Length: 1448
Payload Data Pointer: 0x17fd41ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27224, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928856
Payload Length: 24
Payload Data Pointer: 0x17fd42802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20535, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928857
Payload Length: 1448
Payload Data Pointer: 0x17fd43a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60355, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928857
Payload Length: 1448
Payload Data Pointer: 0x17fd443c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26712, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928857
Payload Length: 24
Payload Data Pointer: 0x17fe36782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/443154058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57087, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 1448
Payload Data Pointer: 0x17fe370c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64021, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 1448
Payload Data Pointer: 0x17fe78f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59924, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 12
Payload Data Pointer: 0x17f8f6e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45394, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 1448
Payload Data Pointer: 0x17f8f8a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49991, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 1058
Payload Data Pointer: 0x17f8f9382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55124, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 0
Payload Data Pointer: 0x17f8f9cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 10: TCP_ST_CLOSE_WAIT
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47867, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 1448
Payload Data Pointer: 0x17f8fa602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13818, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 1448
Payload Data Pointer: 0x17f8faf42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20752, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 1448
Payload Data Pointer: 0x17ecbcf02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51963, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 510262922/2331928860
Payload Length: 904
Payload Data Pointer: 0x17ecbeac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 3332, dport: 20480
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
Stream 10, port: 1035, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1035, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928860/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928860/275381898
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54868, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 527040138/2331928860
Payload Length: 0
Payload Data Pointer: 0x17ecbf402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54868, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 527040138/2331928860
Payload Length: 0
Payload Data Pointer: 0x17ecfe442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1035, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54868, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 527040138/2331928860
Payload Length: 0
Payload Data Pointer: 0x17ed00002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17906, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 527040138/2331928860
Payload Length: 24
Payload Data Pointer: 0x17ed00942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 586, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 527040138/2331928860
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ed0128a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
Stream 12 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 12 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928861/510262922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928861/527040138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928861/527040138
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 36213, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 527040138/2331928861
Payload Length: 0
Payload Data Pointer: 0x17ed01bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928861/527040138
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 25461, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 527040138/2331928861
Payload Length: 0
Payload Data Pointer: 0x17ed02502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53332, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928861
Payload Length: 0
Payload Data Pointer: 0x17ed02e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8193
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17975, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928861
Payload Length: 1448
Payload Data Pointer: 0x17f0cbd42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57795, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928861
Payload Length: 1448
Payload Data Pointer: 0x17f904c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24152, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928861
Payload Length: 24
Payload Data Pointer: 0x17f9055c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/527040138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53434, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 142
Payload Data Pointer: 0x17f979902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 3588, dport: 20480
Stream 11, port: 1036, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1036, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928865/359267978
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54015, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 1448
Payload Data Pointer: 0x17f97ab82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60949, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 1448
Payload Data Pointer: 0x17f97b4c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56852, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 12
Payload Data Pointer: 0x17f9a6a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42322, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 1448
Payload Data Pointer: 0x17ed75f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30789, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 892
Payload Data Pointer: 0x17fd805c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 892, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2340
my calculated merged len: 2340, recv_next: 8169, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52052, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 0
Payload Data Pointer: 0x17fd80f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52308, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 0
Payload Data Pointer: 0x17fd84682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5828
data_avail: 2340
MTP Receive Chain returned: 2340
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1036, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52308, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 0
Payload Data Pointer: 0x17fd84fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63561, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 594149002/2331928865
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fd8590a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 13 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 13 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928865/594149002
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45399, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 594149002/2331928865
Payload Length: 166
Payload Data Pointer: 0x17fd88742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 3844, dport: 20480
Stream 12, port: 1037, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928866/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1037, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928866/594149002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928866/426376842
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 33653, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 610926218/2331928865
Payload Length: 0
Payload Data Pointer: 0x17fd89082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928866/610926218
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51540, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 610926218/2331928866
Payload Length: 0
Payload Data Pointer: 0x17fd899c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1037, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51540, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 610926218/2331928866
Payload Length: 0
Payload Data Pointer: 0x17fd8a302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62793, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 610926218/2331928866
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f0ad30a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 14 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 14 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928867/610926218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928867/610926218
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 22901, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 610926218/2331928865
Payload Length: 0
Payload Data Pointer: 0x17f0aeec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 32885, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 610926218/2331928867
Payload Length: 0
Payload Data Pointer: 0x17f0af802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928867/610926218
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 21877, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 627703434/2331928867
Payload Length: 0
Payload Data Pointer: 0x17f0b0142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15159, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928866
Payload Length: 1448
Payload Data Pointer: 0x17f0b0a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928870/610926218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54979, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928866
Payload Length: 1448
Payload Data Pointer: 0x17f0e0102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21336, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928866
Payload Length: 24
Payload Data Pointer: 0x17f1781c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14647, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928867
Payload Length: 1448
Payload Data Pointer: 0x17f1e4382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54467, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928867
Payload Length: 1448
Payload Data Pointer: 0x17f1e5602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20824, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928867
Payload Length: 24
Payload Data Pointer: 0x17f1e5f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928870/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928870/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928870/627703434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928870/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928870/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51199, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 1448
Payload Data Pointer: 0x17f1e6882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58133, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 1448
Payload Data Pointer: 0x17f1e96c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54036, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 12
Payload Data Pointer: 0x17f1ea002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39506, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 1448
Payload Data Pointer: 0x17f1ea942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44103, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 1058
Payload Data Pointer: 0x17f211502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49236, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 0
Payload Data Pointer: 0x17f2130c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 13: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 4100, dport: 20480
Stream 13, port: 1038, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1038, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928871/443154058
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41979, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 1448
Payload Data Pointer: 0x17f213a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7930, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 1448
Payload Data Pointer: 0x17f214342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14864, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 1448
Payload Data Pointer: 0x17f214c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46075, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 678035082/2331928870
Payload Length: 904
Payload Data Pointer: 0x17f218402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48724, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 694812298/2331928871
Payload Length: 0
Payload Data Pointer: 0x17f218d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48724, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 694812298/2331928871
Payload Length: 0
Payload Data Pointer: 0x17f219682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1038, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48724, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 694812298/2331928871
Payload Length: 0
Payload Data Pointer: 0x17f23f902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59977, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 694812298/2331928871
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f3185ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11762, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 694812298/2331928871
Window Scale: 7
Payload Length: 24
Payload Data Pointer: 0x17f318f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
Stream 15 at state TCP_ST_LISTEN
In EPOLLIN
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
****************************
Stream 15 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/694812298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/694812298
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/678035082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 30325, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 694812298/2331928871
Payload Length: 0
Payload Data Pointer: 0x17f31a182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928871/694812298
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 19573, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 694812298/2331928871
Payload Length: 0
Payload Data Pointer: 0x17f31aac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48570, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928871
Payload Length: 142
Payload Data Pointer: 0x17f31b402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47444, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928871
Payload Length: 0
Payload Data Pointer: 0x17f31bd42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 14: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 4356, dport: 20480
Stream 14, port: 1039, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/694812298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1039, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928875/527040138
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12087, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928871
Payload Length: 1448
Payload Data Pointer: 0x17fbd3f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51907, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928871
Payload Length: 1448
Payload Data Pointer: 0x17fbd48c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 18264, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928871
Payload Length: 24
Payload Data Pointer: 0x17fbd6dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/694812298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46420, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 0
Payload Data Pointer: 0x17fbd7702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46420, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 0
Payload Data Pointer: 0x17fbd8042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1039, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46420, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 0
Payload Data Pointer: 0x17fbd8982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57673, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 761921162/2331928875
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fbdc10a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 16 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 16 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32539, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 1448
Payload Data Pointer: 0x17fbdef42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27938, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 1448
Payload Data Pointer: 0x17ef5f9c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12048, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 1448
Payload Data Pointer: 0x17ef60c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22804, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 880
Payload Data Pointer: 0x17ef61582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49980, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 24
Payload Data Pointer: 0x17ef8af82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46164, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 0
Payload Data Pointer: 0x17ef9e0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 28021, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 0
Payload Data Pointer: 0x17fd9c1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39511, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 761921162/2331928875
Payload Length: 166
Payload Data Pointer: 0x17fd9dd82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 4612, dport: 20480
Stream 15, port: 1040, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1040, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928875/761921162
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928875/594149002
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45908, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 778698378/2331928875
Payload Length: 0
Payload Data Pointer: 0x17fd9e6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1040, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45908, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 778698378/2331928875
Payload Length: 0
Payload Data Pointer: 0x17fd9f002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 17013, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 778698378/2331928875
Payload Length: 0
Payload Data Pointer: 0x17fd9f942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57161, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 778698378/2331928875
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fda028a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 17 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 17 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928876/778698378
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928876/778698378
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 27253, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 778698378/2331928876
Payload Length: 0
Payload Data Pointer: 0x17f1737c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928876/778698378
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 16501, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 778698378/2331928876
Payload Length: 0
Payload Data Pointer: 0x17f175382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9527, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928875
Payload Length: 1448
Payload Data Pointer: 0x17f175cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/778698378
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49347, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928875
Payload Length: 1448
Payload Data Pointer: 0x17f1eb282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15704, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928875
Payload Length: 24
Payload Data Pointer: 0x17ec62c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9015, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928876
Payload Length: 1448
Payload Data Pointer: 0x17ec622c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48835, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928876
Payload Length: 1448
Payload Data Pointer: 0x17f1efc82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15192, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928876
Payload Length: 24
Payload Data Pointer: 0x17f1f05c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/778698378
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45311, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 1448
Payload Data Pointer: 0x17f1f0f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52245, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 1448
Payload Data Pointer: 0x17f1f1842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48148, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 12
Payload Data Pointer: 0x17fad0642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 12
my calculated merged len: 12, recv_next: 5829, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 5816
data_avail: 12
MTP Receive Chain returned: 12
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33618, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 1448
Payload Data Pointer: 0x17fad0f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38215, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 1058
Payload Data Pointer: 0x17fad18c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43348, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 0
Payload Data Pointer: 0x17fad2202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 16: TCP_ST_CLOSE_WAIT
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36091, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 1448
Payload Data Pointer: 0x17fad2b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2042, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 1448
Payload Data Pointer: 0x17fb4f002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8976, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 1448
Payload Data Pointer: 0x17fbba882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40187, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 845807242/2331928880
Payload Length: 904
Payload Data Pointer: 0x17f865382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 4868, dport: 20480
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
Stream 16, port: 1041, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1041, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928880/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928880/610926218
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43092, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 862584458/2331928880
Payload Length: 0
Payload Data Pointer: 0x17f865cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43092, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 862584458/2331928880
Payload Length: 0
Payload Data Pointer: 0x17f869442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1041, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43092, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 862584458/2331928880
Payload Length: 0
Payload Data Pointer: 0x17f869d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6130, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 862584458/2331928880
Payload Length: 24
Payload Data Pointer: 0x17f86a6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928882/845807242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54345, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 862584458/2331928880
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f86d50a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 18 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 18 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928882/862584458
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928882/862584458
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 23925, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 879361674/2331928882
Payload Length: 0
Payload Data Pointer: 0x17f86de42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928882/879361674
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 13173, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 879361674/2331928882
Payload Length: 0
Payload Data Pointer: 0x17f86e782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42426, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928882
Payload Length: 142
Payload Data Pointer: 0x17f86fa02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41300, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928882
Payload Length: 0
Payload Data Pointer: 0x17fc70a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 17: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 5124, dport: 20480
Stream 17, port: 1042, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/862584458
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1042, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928885/694812298
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5943, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928882
Payload Length: 1448
Payload Data Pointer: 0x17fc72602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45763, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928882
Payload Length: 1448
Payload Data Pointer: 0x17fc72f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12120, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928882
Payload Length: 24
Payload Data Pointer: 0x17fc73882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/879361674
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40532, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 0
Payload Data Pointer: 0x17fc741c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40532, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 0
Payload Data Pointer: 0x17efedd42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1042, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40532, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 0
Payload Data Pointer: 0x17f022702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51785, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 929693322/2331928885
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f02554a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 19 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 19 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928885/929693322
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39874, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 1448
Payload Data Pointer: 0x17f4cb1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42878, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 1448
Payload Data Pointer: 0x17f4cbb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6160, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 1448
Payload Data Pointer: 0x17f4cc442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37371, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 904
Payload Data Pointer: 0x17f503302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40276, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 0
Payload Data Pointer: 0x17f527082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 22133, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 929693322/2331928885
Payload Length: 0
Payload Data Pointer: 0x17f332f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/929693322
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33111, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 946470538/2331928886
Payload Length: 166
Payload Data Pointer: 0x17f334b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 5380, dport: 20480
Stream 18, port: 1043, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/929693322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1043, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928886/946470538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928886/761921162
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 11125, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 946470538/2331928885
Payload Length: 0
Payload Data Pointer: 0x17f335442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39764, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 946470538/2331928886
Payload Length: 0
Payload Data Pointer: 0x17f335d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1043, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39764, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 946470538/2331928886
Payload Length: 0
Payload Data Pointer: 0x17f3366c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51017, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 946470538/2331928886
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f33700a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 20 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 20 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928887/946470538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928887/946470538
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 20853, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 963247754/2331928887
Payload Length: 0
Payload Data Pointer: 0x17f7ecf82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928887/963247754
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 10101, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 963247754/2331928887
Payload Length: 0
Payload Data Pointer: 0x17f7ed8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3383, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928886
Payload Length: 1448
Payload Data Pointer: 0x17f7ee202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43203, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928886
Payload Length: 1448
Payload Data Pointer: 0x17f7f1042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9560, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928886
Payload Length: 24
Payload Data Pointer: 0x17f7f1982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928890/946470538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928890/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928890/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2871, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928887
Payload Length: 1448
Payload Data Pointer: 0x17f7f22c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42691, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928887
Payload Length: 1448
Payload Data Pointer: 0x17f7f2c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9048, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928887
Payload Length: 24
Payload Data Pointer: 0x17f7f3542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928890/963247754
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928890/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928890/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39423, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 1448
Payload Data Pointer: 0x17f7f3e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46357, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 1448
Payload Data Pointer: 0x17f7f47c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42260, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 12
Payload Data Pointer: 0x17ee78f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1460
my calculated merged len: 1460, recv_next: 5829, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 4368
data_avail: 1460
MTP Receive Chain returned: 1460
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27730, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 1448
Payload Data Pointer: 0x17ee79842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16197, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 892
Payload Data Pointer: 0x17ee7a182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 892, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2340
my calculated merged len: 2340, recv_next: 8169, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37460, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 0
Payload Data Pointer: 0x17ee7aac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30203, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 1448
Payload Data Pointer: 0x17ee7b402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61689, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 1448
Payload Data Pointer: 0x17eeb47c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3088, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 1448
Payload Data Pointer: 0x17eed6042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34299, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1013579402/2331928890
Payload Length: 904
Payload Data Pointer: 0x17ee01442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5828
data_avail: 2340
MTP Receive Chain returned: 2340
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30295, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1030356618/2331928891
Payload Length: 166
Payload Data Pointer: 0x17ee03002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 5636, dport: 20480
Stream 19, port: 1044, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1044, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1030356618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928891/778698378
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65521, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1030356618/2331928891
Payload Length: 24
Payload Data Pointer: 0x17ee03942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928891/1013579402
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36948, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1030356618/2331928891
Payload Length: 0
Payload Data Pointer: 0x17ee04282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1044, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36948, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1030356618/2331928891
Payload Length: 0
Payload Data Pointer: 0x17ee070c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48201, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1030356618/2331928891
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f30798a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 21 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 21 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928892/1030356618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928892/1030356618
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 18037, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1047133834/2331928892
Payload Length: 0
Payload Data Pointer: 0x17f3082c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928892/1047133834
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 7285, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1047133834/2331928892
Payload Length: 0
Payload Data Pointer: 0x17f308c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36538, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928891
Payload Length: 142
Payload Data Pointer: 0x17f32ee82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35412, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928891
Payload Length: 0
Payload Data Pointer: 0x17f32f7c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 20: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 5892, dport: 20480
Stream 20, port: 1045, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1030356618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1045, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928896/862584458
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65334, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928892
Payload Length: 1448
Payload Data Pointer: 0x17f330102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39619, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928892
Payload Length: 1448
Payload Data Pointer: 0x17f330a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5976, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928892
Payload Length: 24
Payload Data Pointer: 0x17ed38142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1047133834
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34132, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 0
Payload Data Pointer: 0x17fd41582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34132, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 0
Payload Data Pointer: 0x17f7676c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1045, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34132, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 0
Payload Data Pointer: 0x17f7a5dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45385, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1114242698/2331928896
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fdd308a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 22 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 22 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20251, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 1448
Payload Data Pointer: 0x17fdd4302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15650, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 1448
Payload Data Pointer: 0x17fdd4c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65295, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 1448
Payload Data Pointer: 0x17fdd7142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10516, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 880
Payload Data Pointer: 0x17fe223c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928896/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37692, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 24
Payload Data Pointer: 0x17fe56442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33876, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 0
Payload Data Pointer: 0x17fa90382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 15733, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 0
Payload Data Pointer: 0x17fa91f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27223, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 166
Payload Data Pointer: 0x17fa92882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 6148, dport: 20480
Stream 21, port: 1046, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1046, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1114242698
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928897/929693322
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33620, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928897
Payload Length: 0
Payload Data Pointer: 0x17fa931c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1046, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33620, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928897
Payload Length: 0
Payload Data Pointer: 0x17fa93b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 4981, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1114242698/2331928896
Payload Length: 0
Payload Data Pointer: 0x17fa94442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44873, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1114242698/2331928897
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ef4754a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 23 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 23 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1114242698
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 14965, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1131019914/2331928897
Payload Length: 0
Payload Data Pointer: 0x17ef47e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928897/1131019914
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 4213, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1131019914/2331928897
Payload Length: 0
Payload Data Pointer: 0x17ef487c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62518, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928897
Payload Length: 1448
Payload Data Pointer: 0x17ef4bf42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928897
Payload Length: 1448
Payload Data Pointer: 0x17ef4c882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3160, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928897
Payload Length: 24
Payload Data Pointer: 0x17ef4d1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1114242698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62262, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928897
Payload Length: 1448
Payload Data Pointer: 0x17ef51282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36547, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928897
Payload Length: 1448
Payload Data Pointer: 0x17ef51bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2904, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928897
Payload Length: 24
Payload Data Pointer: 0x17ef52502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1131019914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30658, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 1448
Payload Data Pointer: 0x17ef52e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33662, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 1448
Payload Data Pointer: 0x17f314502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62479, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 1448
Payload Data Pointer: 0x17f314e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28155, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 904
Payload Data Pointer: 0x17f315782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 1448
Payload Data Pointer: 0x17f3160c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55289, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 1448
Payload Data Pointer: 0x17f316a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62223, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 1448
Payload Data Pointer: 0x17f34d8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27899, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 904
Payload Data Pointer: 0x17f3703c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31060, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 0
Payload Data Pointer: 0x17f56e242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928901/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24407, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 166
Payload Data Pointer: 0x17f56eb82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 6404, dport: 20480
Stream 22, port: 1047, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928902/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1047, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928902/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928902/946470538
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59633, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1198128778/2331928901
Payload Length: 24
Payload Data Pointer: 0x17f572302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928902/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30548, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1214905994/2331928902
Payload Length: 0
Payload Data Pointer: 0x17f572c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1047, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30548, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1214905994/2331928902
Payload Length: 0
Payload Data Pointer: 0x17f573582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41801, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1214905994/2331928902
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f5763ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 24 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 24 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928902/1214905994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928902/1214905994
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 12149, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1214905994/2331928902
Payload Length: 0
Payload Data Pointer: 0x17f576d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928903/1214905994
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 1397, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1214905994/2331928902
Payload Length: 0
Payload Data Pointer: 0x17f577f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30394, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928902
Payload Length: 142
Payload Data Pointer: 0x17f5788c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29268, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928902
Payload Length: 0
Payload Data Pointer: 0x17f97ec42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 23: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 6660, dport: 20480
Stream 23, port: 1048, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1198128778
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1048, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928906/1030356618
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59190, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928903
Payload Length: 1448
Payload Data Pointer: 0x17f980802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33475, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928903
Payload Length: 1448
Payload Data Pointer: 0x17f981142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65367, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928903
Payload Length: 24
Payload Data Pointer: 0x17f981a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1214905994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28244, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17f9848c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28244, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17f985202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1048, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28244, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17f985b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39497, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1282014858/2331928906
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f98648a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 25 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 25 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27586, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 1448
Payload Data Pointer: 0x17fe62682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30590, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 1448
Payload Data Pointer: 0x17fe62fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59407, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 1448
Payload Data Pointer: 0x17fe63902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25083, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 904
Payload Data Pointer: 0x17fe64242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27988, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17ecc8802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 9845, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17ec63e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21335, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 166
Payload Data Pointer: 0x17f02c442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 6916, dport: 20480
Stream 24, port: 1049, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1049, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928906/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928906/1114242698
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 64628, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17f02e002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58166, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 1448
Payload Data Pointer: 0x17f02e942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32451, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 1448
Payload Data Pointer: 0x17f02f282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64343, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 24
Payload Data Pointer: 0x17f02fbc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27988, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17f030502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1049, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27988, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928906
Payload Length: 0
Payload Data Pointer: 0x17f52b142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39241, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1282014858/2331928906
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f52ba8a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 26 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 26 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27074, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17f52df82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30078, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17f52fb42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58895, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17f530482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24571, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928907
Payload Length: 904
Payload Data Pointer: 0x17f530dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27476, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1282014858/2331928907
Payload Length: 0
Payload Data Pointer: 0x17f531702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 9077, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 0
Payload Data Pointer: 0x17f532042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20567, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 166
Payload Data Pointer: 0x17f532982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 7172, dport: 20480
Stream 25, port: 1050, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1282014858
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1050, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928907/1114242698
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 63860, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 0
Payload Data Pointer: 0x17f5332c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57398, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17ee98282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31683, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17ee98bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63575, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 24
Payload Data Pointer: 0x17ee99502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27220, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 0
Payload Data Pointer: 0x17ee99e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1050, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27220, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 0
Payload Data Pointer: 0x17ee9ba02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38473, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1298792074/2331928907
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17eebee4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 27 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 27 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13339, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17eee8842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8738, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17fcba102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58383, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 1448
Payload Data Pointer: 0x17fcbaa42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3604, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 880
Payload Data Pointer: 0x17fcbe1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26964, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 0
Payload Data Pointer: 0x17fcbeb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8145
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928907/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30780, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 24
Payload Data Pointer: 0x17fcbf442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 8821, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1298792074/2331928907
Payload Length: 0
Payload Data Pointer: 0x17fcc2282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 8144
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928908/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928908/1298792074
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20055, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1315569290/2331928907
Payload Length: 166
Payload Data Pointer: 0x17fcc2bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 7428, dport: 20480
Stream 26, port: 1051, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928908/1298792074
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1051, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928908/1315569290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928908/1214905994
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 63348, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1315569290/2331928907
Payload Length: 0
Payload Data Pointer: 0x17fcc3502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26452, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1315569290/2331928908
Payload Length: 0
Payload Data Pointer: 0x17fcc4782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1051, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26452, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1315569290/2331928908
Payload Length: 0
Payload Data Pointer: 0x17f0a5182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37705, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1315569290/2331928908
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f0a6d4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 28 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 28 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928909/1315569290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928909/1315569290
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 7541, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1332346506/2331928909
Payload Length: 0
Payload Data Pointer: 0x17f0a7682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928909/1332346506
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 62324, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1332346506/2331928909
Payload Length: 0
Payload Data Pointer: 0x17f0a7fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55606, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928908
Payload Length: 1448
Payload Data Pointer: 0x17f0a8902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29891, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928908
Payload Length: 1448
Payload Data Pointer: 0x17f5faa02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61783, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928908
Payload Length: 24
Payload Data Pointer: 0x17f6181c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928912/1315569290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928912/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928912/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55094, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928909
Payload Length: 1448
Payload Data Pointer: 0x17f61b002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29379, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928909
Payload Length: 1448
Payload Data Pointer: 0x17f62cec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61271, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928909
Payload Length: 24
Payload Data Pointer: 0x17fb96b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928912/1332346506
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928912/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928912/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23746, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 1448
Payload Data Pointer: 0x17fb97442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26750, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 1448
Payload Data Pointer: 0x17fc17082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55567, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 1448
Payload Data Pointer: 0x17fc36402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21243, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 904
Payload Data Pointer: 0x17f75c702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16891, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 1448
Payload Data Pointer: 0x17f75d042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48377, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 1448
Payload Data Pointer: 0x17f75d982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55311, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 1448
Payload Data Pointer: 0x17f7607c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20987, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 904
Payload Data Pointer: 0x17f761102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24148, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928912
Payload Length: 0
Payload Data Pointer: 0x17f761a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17239, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1382678154/2331928913
Payload Length: 166
Payload Data Pointer: 0x17fd9d442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 7684, dport: 20480
Stream 27, port: 1052, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1052, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928913/1282014858
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52209, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1399455370/2331928913
Payload Length: 24
Payload Data Pointer: 0x17fd9f942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1382678154
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23636, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1399455370/2331928913
Payload Length: 0
Payload Data Pointer: 0x17fda0282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1052, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23636, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1399455370/2331928913
Payload Length: 0
Payload Data Pointer: 0x17ed8ac02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34889, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1399455370/2331928913
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ed8b54a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 29 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 29 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1399455370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928913/1399455370
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 5237, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1399455370/2331928913
Payload Length: 0
Payload Data Pointer: 0x17ed8be82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928914/1399455370
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 59764, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1416232586/2331928913
Payload Length: 0
Payload Data Pointer: 0x17ed8c7c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23226, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928913
Payload Length: 142
Payload Data Pointer: 0x17ed8d102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22100, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928913
Payload Length: 0
Payload Data Pointer: 0x17ed8da42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 28: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 7940, dport: 20480
Stream 28, port: 1053, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1399455370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1053, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928918/1282014858
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52022, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928914
Payload Length: 1448
Payload Data Pointer: 0x17ed8e382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26307, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928914
Payload Length: 1448
Payload Data Pointer: 0x17f209382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58199, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928914
Payload Length: 24
Payload Data Pointer: 0x17f20c1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1416232586
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20820, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 0
Payload Data Pointer: 0x17f797682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20820, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 0
Payload Data Pointer: 0x17f797fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1053, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20820, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 0
Payload Data Pointer: 0x17f798902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32073, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1483341450/2331928918
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f7c63ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 30 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 30 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6939, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 1448
Payload Data Pointer: 0x17f7e7302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2338, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 1448
Payload Data Pointer: 0x17fc69b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51983, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 1448
Payload Data Pointer: 0x17fc6a482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62739, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 880
Payload Data Pointer: 0x17fc6dc02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928918/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24380, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 24
Payload Data Pointer: 0x17fc6e542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20564, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 0
Payload Data Pointer: 0x17fc6ee82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 2421, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 0
Payload Data Pointer: 0x17ed349c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13911, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1483341450/2331928918
Payload Length: 166
Payload Data Pointer: 0x17fc74b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 8196, dport: 20480
Stream 29, port: 1054, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1054, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1483341450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1483341450
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928919/1298792074
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20052, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1500118666/2331928919
Payload Length: 0
Payload Data Pointer: 0x17ed33742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1054, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20052, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1500118666/2331928919
Payload Length: 0
Payload Data Pointer: 0x17fdb0582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 56948, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1500118666/2331928918
Payload Length: 0
Payload Data Pointer: 0x17efeb842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31305, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1500118666/2331928919
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17efed40a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 31 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 31 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1500118666
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1500118666
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 1653, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1500118666/2331928919
Payload Length: 0
Payload Data Pointer: 0x17efee682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928919/1500118666
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 56436, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1500118666/2331928919
Payload Length: 0
Payload Data Pointer: 0x17ec94782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49206, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928919
Payload Length: 1448
Payload Data Pointer: 0x17eff14c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23491, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928919
Payload Length: 1448
Payload Data Pointer: 0x17eff1e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55383, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928919
Payload Length: 24
Payload Data Pointer: 0x17eff2742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1500118666
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48950, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928919
Payload Length: 1448
Payload Data Pointer: 0x17eff3082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23235, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928919
Payload Length: 1448
Payload Data Pointer: 0x17f4aec82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55127, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928919
Payload Length: 24
Payload Data Pointer: 0x17f4aff02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1500118666
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17346, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 1448
Payload Data Pointer: 0x17f4b0842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20350, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 1448
Payload Data Pointer: 0x17f4b1182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49167, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 1448
Payload Data Pointer: 0x17f4dab82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14843, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 904
Payload Data Pointer: 0x17f9bf842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10491, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 1448
Payload Data Pointer: 0x17f710202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41977, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 1448
Payload Data Pointer: 0x17f710b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48911, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 1448
Payload Data Pointer: 0x17f711482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14587, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 904
Payload Data Pointer: 0x17f7142c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17748, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 0
Payload Data Pointer: 0x17f714c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11095, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 166
Payload Data Pointer: 0x17f715542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 8452, dport: 20480
Stream 30, port: 1055, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1055, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928923/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928923/1315569290
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46321, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1567227530/2331928923
Payload Length: 24
Payload Data Pointer: 0x17ee05502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928924/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17492, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1584004746/2331928923
Payload Length: 0
Payload Data Pointer: 0x17ee08342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1055, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17492, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1584004746/2331928923
Payload Length: 0
Payload Data Pointer: 0x17f32ee82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28745, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1584004746/2331928923
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f32f7ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 32 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 32 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928924/1584004746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928924/1584004746
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 64372, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1584004746/2331928924
Payload Length: 0
Payload Data Pointer: 0x17fc6f7c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928924/1584004746
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 53620, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1584004746/2331928924
Payload Length: 0
Payload Data Pointer: 0x17ee08c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17082, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928924
Payload Length: 142
Payload Data Pointer: 0x17ee095c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8335, cur_stream->mtp->last_flushed: 8192
data_avail: 142
MTP Receive Chain returned: 142
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1567227530
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15956, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928924
Payload Length: 0
Payload Data Pointer: 0x17f309e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 31: TCP_ST_CLOSE_WAIT
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46134, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928924
Payload Length: 1448
Payload Data Pointer: 0x17f330102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20419, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928924
Payload Length: 1448
Payload Data Pointer: 0x17ed35c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52311, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928924
Payload Length: 24
Payload Data Pointer: 0x17ef1d202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 8708, dport: 20480
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
Stream 31, port: 1056, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1056, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1584004746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928928/1399455370
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14932, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 0
Payload Data Pointer: 0x17ef1edc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14932, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 0
Payload Data Pointer: 0x17ef1f702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1056, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14932, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 0
Payload Data Pointer: 0x17ef20042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14274, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 1448
Payload Data Pointer: 0x17f434cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17278, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 1448
Payload Data Pointer: 0x17f458102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46095, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 1448
Payload Data Pointer: 0x17ec48282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11771, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 904
Payload Data Pointer: 0x17f1f4fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26185, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1651113610/2331928928
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f1f874a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
Stream 33 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 33 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14676, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 0
Payload Data Pointer: 0x17f1f9082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8023, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 166
Payload Data Pointer: 0x17f1f99c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 8964, dport: 20480
Stream 32, port: 1057, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1057, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928928/1651113610
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928928/1483341450
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 62068, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1651113610/2331928928
Payload Length: 0
Payload Data Pointer: 0x17f1fc802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928929/1651113610
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14420, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1667890826/2331928928
Payload Length: 0
Payload Data Pointer: 0x17f1fd142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1057, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14420, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1667890826/2331928928
Payload Length: 0
Payload Data Pointer: 0x17f1fda82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25673, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1667890826/2331928928
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f1fed0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 34 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 34 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928929/1667890826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928929/1667890826
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 51060, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1667890826/2331928928
Payload Length: 0
Payload Data Pointer: 0x17f66e402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 61300, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1667890826/2331928929
Payload Length: 0
Payload Data Pointer: 0x17f66ed42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928929/1667890826
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 50548, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1667890826/2331928929
Payload Length: 0
Payload Data Pointer: 0x17f671242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43318, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928929
Payload Length: 1448
Payload Data Pointer: 0x17f671b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17603, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928929
Payload Length: 1448
Payload Data Pointer: 0x17f6724c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49495, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928929
Payload Length: 24
Payload Data Pointer: 0x17f675302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1667890826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43062, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928929
Payload Length: 1448
Payload Data Pointer: 0x17f675c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17347, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928929
Payload Length: 1448
Payload Data Pointer: 0x17f71f282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49239, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928929
Payload Length: 24
Payload Data Pointer: 0x17f720502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1667890826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11458, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 1448
Payload Data Pointer: 0x17f720e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14462, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 1448
Payload Data Pointer: 0x17f721782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43279, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 1448
Payload Data Pointer: 0x17f7220c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8955, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 904
Payload Data Pointer: 0x17f724f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4603, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 1448
Payload Data Pointer: 0x17f725842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36089, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 1448
Payload Data Pointer: 0x17f777082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43023, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 1448
Payload Data Pointer: 0x17f7779c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8699, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 904
Payload Data Pointer: 0x17f778302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11860, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 0
Payload Data Pointer: 0x17f778c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5207, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1734999690/2331928933
Payload Length: 166
Payload Data Pointer: 0x17f779582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 9220, dport: 20480
Stream 33, port: 1058, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1058, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928933/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928933/1500118666
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40177, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1751776906/2331928933
Payload Length: 24
Payload Data Pointer: 0x17f77d642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11604, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1751776906/2331928933
Payload Length: 0
Payload Data Pointer: 0x17f787cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1058, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11604, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1751776906/2331928933
Payload Length: 0
Payload Data Pointer: 0x17f7b7c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22857, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1751776906/2331928933
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f7b8f0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
Stream 35 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 35 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928934/1734999690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928934/1751776906
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928934/1751776906
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 58484, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1751776906/2331928934
Payload Length: 0
Payload Data Pointer: 0x17f7b9842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928935/1751776906
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 47732, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1751776906/2331928934
Payload Length: 0
Payload Data Pointer: 0x17f7ba182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11194, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928934
Payload Length: 142
Payload Data Pointer: 0x17f7bcfc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10068, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928934
Payload Length: 0
Payload Data Pointer: 0x17f7bd902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 34: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 9476, dport: 20480
Stream 34, port: 1059, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1751776906
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1059, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928938/1584004746
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39990, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928935
Payload Length: 1448
Payload Data Pointer: 0x17f7be242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14275, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928935
Payload Length: 1448
Payload Data Pointer: 0x17f7eaa82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46167, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928935
Payload Length: 24
Payload Data Pointer: 0x17f7ec642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1751776906
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9044, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 0
Payload Data Pointer: 0x17f7eeb42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9044, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 0
Payload Data Pointer: 0x17f1a40c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1059, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9044, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 0
Payload Data Pointer: 0x17f1a4a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20297, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1818885770/2331928938
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17eef78ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8386, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 1448
Payload Data Pointer: 0x17eef8202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 5272
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4368
my calculated merged len: 4368, recv_next: 4369, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 29, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11390, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 1448
Payload Data Pointer: 0x17ef384c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 3824
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5816
my calculated merged len: 5816, recv_next: 5817, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40207, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 1448
Payload Data Pointer: 0x17ef42202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 2376
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 7264
my calculated merged len: 7264, recv_next: 7265, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5883, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 904
Payload Data Pointer: 0x17f665002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 928
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 8168
my calculated merged len: 8168, recv_next: 8169, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8788, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1818885770/2331928938
Payload Length: 0
Payload Data Pointer: 0x17f666282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 18, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 7, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 0, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 0, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928938/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 0
data_avail: 8168
MTP Receive Chain returned: 8168
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
Stream 36 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 36 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928941/1818885770
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928941/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 55412, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928938
Payload Length: 0
Payload Data Pointer: 0x17f666bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 599, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928941
Payload Length: 166
Payload Data Pointer: 0x17f699082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 9732, dport: 20480
Stream 35, port: 1060, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928941/1869217418
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928941/1818885770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1060, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928941/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928941/1651113610
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 43892, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928941
Payload Length: 0
Payload Data Pointer: 0x17f6ba902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7252, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928941
Payload Length: 0
Payload Data Pointer: 0x17f24c482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1060, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7252, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928941
Payload Length: 0
Payload Data Pointer: 0x17f24cdc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 18505, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1869217418/2331928941
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f24d70a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 37 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 37 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37430, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928941
Payload Length: 1448
Payload Data Pointer: 0x17f250542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11715, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928941
Payload Length: 1448
Payload Data Pointer: 0x17f250e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43607, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928941
Payload Length: 24
Payload Data Pointer: 0x17f2517c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 54132, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928942
Payload Length: 0
Payload Data Pointer: 0x17f909fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65274, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928942
Payload Length: 1448
Payload Data Pointer: 0x17f90a902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31225, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928942
Payload Length: 1448
Payload Data Pointer: 0x17f90ce02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38159, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928942
Payload Length: 1448
Payload Data Pointer: 0x17f90d742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1869217418/2331928942
Payload Length: 880
Payload Data Pointer: 0x17f90e082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10300, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1885994634/2331928942
Payload Length: 24
Payload Data Pointer: 0x17f90e9c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 43124, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1885994634/2331928942
Payload Length: 0
Payload Data Pointer: 0x17f90f302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 8144
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1869217418
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35313, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1885994634/2331928942
Payload Length: 24
Payload Data Pointer: 0x17f90fc42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928942/1885994634
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6586, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928942
Payload Length: 142
Payload Data Pointer: 0x17f910582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5460, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928942
Payload Length: 0
Payload Data Pointer: 0x17f9158c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 36: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 9988, dport: 20480
Stream 36, port: 1061, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1885994634
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1061, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928946/1667890826
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35638, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928942
Payload Length: 1448
Payload Data Pointer: 0x17fd7fc82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9923, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928942
Payload Length: 1448
Payload Data Pointer: 0x17fd99382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41815, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928942
Payload Length: 24
Payload Data Pointer: 0x17fd99cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1885994634
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4436, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 0
Payload Data Pointer: 0x17fd9a602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4436, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 0
Payload Data Pointer: 0x17f227dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1061, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4436, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 0
Payload Data Pointer: 0x17f27c442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15689, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1953103498/2331928946
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f7426ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 38 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 38 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928946/1953103498
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56090, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 1448
Payload Data Pointer: 0x17f743002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51489, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 1448
Payload Data Pointer: 0x17f746782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35599, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 1448
Payload Data Pointer: 0x17f7470c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46355, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 880
Payload Data Pointer: 0x17f747a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7996, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 24
Payload Data Pointer: 0x17f74a842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4180, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 0
Payload Data Pointer: 0x17f74b182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 51572, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928946
Payload Length: 0
Payload Data Pointer: 0x17f74bac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62806, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1953103498/2331928947
Payload Length: 166
Payload Data Pointer: 0x17f74c402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 10244, dport: 20480
Stream 37, port: 1062, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1062, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1953103498
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928947/1751776906
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3668, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1969880714/2331928947
Payload Length: 0
Payload Data Pointer: 0x17fc30782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1062, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3668, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1969880714/2331928947
Payload Length: 0
Payload Data Pointer: 0x17fc32342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 40564, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1969880714/2331928946
Payload Length: 0
Payload Data Pointer: 0x17fc32c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14921, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 1969880714/2331928947
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fc335ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 39 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 39 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1969880714
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1969880714
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 50804, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1969880714/2331928947
Payload Length: 0
Payload Data Pointer: 0x17fc36d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928947/1969880714
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 40052, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 1969880714/2331928947
Payload Length: 0
Payload Data Pointer: 0x17f7ed8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32566, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928947
Payload Length: 1448
Payload Data Pointer: 0x17fc37682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6851, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928947
Payload Length: 1448
Payload Data Pointer: 0x17fc37fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38743, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928947
Payload Length: 24
Payload Data Pointer: 0x17ef5d4c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/1969880714
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32310, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928947
Payload Length: 1448
Payload Data Pointer: 0x17ef5e742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6595, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928947
Payload Length: 1448
Payload Data Pointer: 0x17ef5f082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38487, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928947
Payload Length: 24
Payload Data Pointer: 0x17ef60302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/1969880714
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 450, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 1448
Payload Data Pointer: 0x17ef893c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3454, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 1448
Payload Data Pointer: 0x17f547fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32271, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 1448
Payload Data Pointer: 0x17f1d93c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63482, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 904
Payload Data Pointer: 0x17f1d9d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59130, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 1448
Payload Data Pointer: 0x17f1da642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25081, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 1448
Payload Data Pointer: 0x17f1dd482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32015, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 1448
Payload Data Pointer: 0x17f1dddc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63226, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 904
Payload Data Pointer: 0x17f1de702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 852, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 0
Payload Data Pointer: 0x17f6b0282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59734, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 166
Payload Data Pointer: 0x17f6b1e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 10500, dport: 20480
Stream 38, port: 1063, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1063, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928952/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928952/1818885770
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29425, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2053766794/2331928952
Payload Length: 24
Payload Data Pointer: 0x17f6b2782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928953/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 596, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2070544010/2331928952
Payload Length: 0
Payload Data Pointer: 0x17f6b30c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1063, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 596, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2070544010/2331928952
Payload Length: 0
Payload Data Pointer: 0x17f6b3a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11849, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2070544010/2331928952
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f6b434a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 40 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 40 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928953/2070544010
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928953/2070544010
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 47476, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2070544010/2331928953
Payload Length: 0
Payload Data Pointer: 0x17f6b4c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928953/2070544010
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 36724, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2070544010/2331928953
Payload Length: 0
Payload Data Pointer: 0x17f6b55c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 186, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928953
Payload Length: 142
Payload Data Pointer: 0x17f6b5f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64595, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928953
Payload Length: 0
Payload Data Pointer: 0x17f6bbb82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 39: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 10756, dport: 20480
Stream 39, port: 1064, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2053766794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1064, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928957/1869217418
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29238, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928953
Payload Length: 1448
Payload Data Pointer: 0x17f9eb742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3523, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928953
Payload Length: 1448
Payload Data Pointer: 0x17f9ed302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35415, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928953
Payload Length: 24
Payload Data Pointer: 0x17f9edc42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2070544010
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63571, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 0
Payload Data Pointer: 0x17f9ee582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63571, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 0
Payload Data Pointer: 0x17ed6a602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1064, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63571, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 0
Payload Data Pointer: 0x17f33a782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9289, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2137652874/2331928957
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fe6b14a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 41 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 41 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62913, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 1448
Payload Data Pointer: 0x17fe6cd02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 382, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 1448
Payload Data Pointer: 0x17fe6d642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29199, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 1448
Payload Data Pointer: 0x17fe6df82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60410, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 904
Payload Data Pointer: 0x17fe6e8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63315, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 0
Payload Data Pointer: 0x17fe732c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928957/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 45172, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2137652874/2331928957
Payload Length: 0
Payload Data Pointer: 0x17f1ac242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928958/2137652874
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56406, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2154430090/2331928957
Payload Length: 166
Payload Data Pointer: 0x17f1ad4c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 11012, dport: 20480
Stream 40, port: 1065, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928958/2137652874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1065, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928958/2154430090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928958/1953103498
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 34164, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2154430090/2331928957
Payload Length: 0
Payload Data Pointer: 0x17f1ade02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2154430090/2331928958
Payload Length: 0
Payload Data Pointer: 0x17f1ae742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1065, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2154430090/2331928958
Payload Length: 0
Payload Data Pointer: 0x17f1af082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8521, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2154430090/2331928958
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f1af9ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 42 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 42 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928959/2154430090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928959/2154430090
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 43892, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2171207306/2331928959
Payload Length: 0
Payload Data Pointer: 0x17f1b0302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928959/2171207306
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 33140, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2171207306/2331928959
Payload Length: 0
Payload Data Pointer: 0x17f1b4d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26422, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928958
Payload Length: 1448
Payload Data Pointer: 0x17f1c2b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 707, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928958
Payload Length: 1448
Payload Data Pointer: 0x17f64e742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32599, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928958
Payload Length: 24
Payload Data Pointer: 0x17f68ea02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2154430090
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25910, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928959
Payload Length: 1448
Payload Data Pointer: 0x17f68fc82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 195, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928959
Payload Length: 1448
Payload Data Pointer: 0x17f6905c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32087, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928959
Payload Length: 24
Payload Data Pointer: 0x17f692ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2171207306
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60097, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 1448
Payload Data Pointer: 0x17f6974c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63101, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 1448
Payload Data Pointer: 0x17fc12682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26383, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 1448
Payload Data Pointer: 0x17f95d3c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57594, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 904
Payload Data Pointer: 0x17f95dd02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53242, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 1448
Payload Data Pointer: 0x17f95e642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19193, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 1448
Payload Data Pointer: 0x17f961482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26127, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 1448
Payload Data Pointer: 0x17f961dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57338, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 904
Payload Data Pointer: 0x17f962702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60499, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 0
Payload Data Pointer: 0x17fdf7742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53846, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 166
Payload Data Pointer: 0x17fdf8082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 11268, dport: 20480
Stream 41, port: 1066, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1066, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928962/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928962/1969880714
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23537, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 24
Payload Data Pointer: 0x17fdfa582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928963/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60499, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 0
Payload Data Pointer: 0x17fdfaec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1066, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60499, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2221538954/2331928962
Payload Length: 0
Payload Data Pointer: 0x17fdfb802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6217, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2221538954/2331928962
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fdfc14a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 43 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 43 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928963/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928963/2221538954
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 41588, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2238316170/2331928963
Payload Length: 0
Payload Data Pointer: 0x17fdfca82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928964/2238316170
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 30836, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2238316170/2331928963
Payload Length: 0
Payload Data Pointer: 0x17fdfd3c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59833, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928963
Payload Length: 142
Payload Data Pointer: 0x17fdfdd02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58707, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928963
Payload Length: 0
Payload Data Pointer: 0x17fe03042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 42: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 11524, dport: 20480
Stream 42, port: 1067, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2221538954
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1067, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928967/2070544010
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23094, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928964
Payload Length: 1448
Payload Data Pointer: 0x17f10ad82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62914, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928964
Payload Length: 1448
Payload Data Pointer: 0x17f10b6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29271, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928964
Payload Length: 24
Payload Data Pointer: 0x17f10c002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2238316170
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57683, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 0
Payload Data Pointer: 0x17f10c942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57683, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 0
Payload Data Pointer: 0x17f6d4002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1067, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57683, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 0
Payload Data Pointer: 0x17f6f61c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3401, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2305425034/2331928967
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f46fc4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 44 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 44 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928967/2305425034
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57025, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 1448
Payload Data Pointer: 0x17f470582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60029, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 1448
Payload Data Pointer: 0x17f473d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23311, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 1448
Payload Data Pointer: 0x17f474642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54522, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 904
Payload Data Pointer: 0x17f474f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57427, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 0
Payload Data Pointer: 0x17f477dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 39284, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2305425034/2331928967
Payload Length: 0
Payload Data Pointer: 0x17f478702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2305425034
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50262, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2322202250/2331928968
Payload Length: 166
Payload Data Pointer: 0x17f479042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 11780, dport: 20480
Stream 43, port: 1068, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2305425034
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1068, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928968/2322202250
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928968/2137652874
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 28276, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2322202250/2331928967
Payload Length: 0
Payload Data Pointer: 0x17f47a2c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2322202250/2331928968
Payload Length: 0
Payload Data Pointer: 0x17f944602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1068, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2322202250/2331928968
Payload Length: 0
Payload Data Pointer: 0x17f9461c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2633, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2322202250/2331928968
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f946b0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 45 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 45 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928969/2322202250
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928969/2322202250
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 38004, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2338979466/2331928969
Payload Length: 0
Payload Data Pointer: 0x17f947442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928969/2338979466
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 27252, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2338979466/2331928969
Payload Length: 0
Payload Data Pointer: 0x17f947d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20278, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928968
Payload Length: 1448
Payload Data Pointer: 0x17fc11d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60098, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928968
Payload Length: 1448
Payload Data Pointer: 0x17fc12fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26455, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928968
Payload Length: 24
Payload Data Pointer: 0x17f19acc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2322202250
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19766, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928969
Payload Length: 1448
Payload Data Pointer: 0x17ec86982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59586, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928969
Payload Length: 1448
Payload Data Pointer: 0x17f19d1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25943, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928969
Payload Length: 24
Payload Data Pointer: 0x17ec86042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2338979466
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53697, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 1448
Payload Data Pointer: 0x17ec84482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56701, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 1448
Payload Data Pointer: 0x17ec83b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19983, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 1448
Payload Data Pointer: 0x17ec83202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51194, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 904
Payload Data Pointer: 0x17f1a8182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46842, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 1448
Payload Data Pointer: 0x17f1b7b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12793, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 1448
Payload Data Pointer: 0x17f1b9702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19727, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 1448
Payload Data Pointer: 0x17f1ba042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50938, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 904
Payload Data Pointer: 0x17f1ba982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54099, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 0
Payload Data Pointer: 0x17f5a47c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928973/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47446, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 166
Payload Data Pointer: 0x17f5a5102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 12036, dport: 20480
Stream 44, port: 1069, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928974/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1069, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928974/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928974/2154430090
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17137, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2406088330/2331928973
Payload Length: 24
Payload Data Pointer: 0x17f5a6cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928974/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53587, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2422865546/2331928974
Payload Length: 0
Payload Data Pointer: 0x17f7504c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1069, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53587, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2422865546/2331928974
Payload Length: 0
Payload Data Pointer: 0x17f750e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64840, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2422865546/2331928974
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f75458a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 46 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 46 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928974/2422865546
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928974/2422865546
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 34932, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2439642762/2331928974
Payload Length: 0
Payload Data Pointer: 0x17f754ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928975/2439642762
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 24180, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2439642762/2331928974
Payload Length: 0
Payload Data Pointer: 0x17f755802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53433, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928974
Payload Length: 142
Payload Data Pointer: 0x17f758642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52307, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928974
Payload Length: 0
Payload Data Pointer: 0x17f758f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 45: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 12292, dport: 20480
Stream 45, port: 1070, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2406088330
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1070, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928978/2221538954
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16694, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928975
Payload Length: 1448
Payload Data Pointer: 0x17f7598c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56514, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928975
Payload Length: 1448
Payload Data Pointer: 0x17f75a202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22871, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928975
Payload Length: 24
Payload Data Pointer: 0x17ec4f182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2439642762
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51283, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 0
Payload Data Pointer: 0x17fda4342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51283, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 0
Payload Data Pointer: 0x17fda4c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1070, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51283, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 0
Payload Data Pointer: 0x17fda55c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62536, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2489974410/2331928978
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fda840a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 47 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 47 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50625, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 1448
Payload Data Pointer: 0x17fda8d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53629, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 1448
Payload Data Pointer: 0x17fda9682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16911, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 1448
Payload Data Pointer: 0x17fda9fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48122, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 904
Payload Data Pointer: 0x17f0b82c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51027, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 0
Payload Data Pointer: 0x17f0b9542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928978/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 32884, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2489974410/2331928978
Payload Length: 0
Payload Data Pointer: 0x17f0b9e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928979/2489974410
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44118, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2506751626/2331928978
Payload Length: 166
Payload Data Pointer: 0x17f0ba7c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 12548, dport: 20480
Stream 46, port: 1071, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928979/2489974410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1071, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928979/2506751626
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928979/2305425034
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 21876, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2506751626/2331928978
Payload Length: 0
Payload Data Pointer: 0x17f0e4b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50515, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2506751626/2331928979
Payload Length: 0
Payload Data Pointer: 0x17f67f042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1071, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50515, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2506751626/2331928979
Payload Length: 0
Payload Data Pointer: 0x17f20d442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61768, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2506751626/2331928979
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f7e730a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 48 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 48 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928980/2506751626
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928980/2506751626
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 31604, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2523528842/2331928980
Payload Length: 0
Payload Data Pointer: 0x17fc33f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928980/2523528842
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 20852, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2523528842/2331928980
Payload Length: 0
Payload Data Pointer: 0x17fc6a482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14134, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928979
Payload Length: 1448
Payload Data Pointer: 0x17fc6dc02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53954, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928979
Payload Length: 1448
Payload Data Pointer: 0x17fc38902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20311, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928979
Payload Length: 24
Payload Data Pointer: 0x17eebad82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2506751626
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13622, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928980
Payload Length: 1448
Payload Data Pointer: 0x17eebb6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53442, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928980
Payload Length: 1448
Payload Data Pointer: 0x17eebdbc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19799, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928980
Payload Length: 24
Payload Data Pointer: 0x17eebe502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2523528842
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47809, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 1448
Payload Data Pointer: 0x17eebf782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50813, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 1448
Payload Data Pointer: 0x17fad5042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14095, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 1448
Payload Data Pointer: 0x17f86de42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45306, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 904
Payload Data Pointer: 0x17eec0a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40954, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 1448
Payload Data Pointer: 0x17eec1342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6905, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 1448
Payload Data Pointer: 0x17eec6682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13839, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 1448
Payload Data Pointer: 0x17f230882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45050, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 904
Payload Data Pointer: 0x17f244c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48211, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 0
Payload Data Pointer: 0x17f245582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928983/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41558, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 166
Payload Data Pointer: 0x17f245ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 12804, dport: 20480
Stream 47, port: 1072, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928984/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1072, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928984/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928984/2322202250
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11249, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2573860490/2331928983
Payload Length: 24
Payload Data Pointer: 0x17f7a9542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928984/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47699, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2590637706/2331928984
Payload Length: 0
Payload Data Pointer: 0x17f7ca482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1072, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47699, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2590637706/2331928984
Payload Length: 0
Payload Data Pointer: 0x17f704902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58952, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2590637706/2331928984
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f70524a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 49 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 49 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928984/2590637706
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928984/2590637706
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 29300, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2590637706/2331928984
Payload Length: 0
Payload Data Pointer: 0x17f7089c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928985/2590637706
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 18292, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2607414922/2331928984
Payload Length: 0
Payload Data Pointer: 0x17f709302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47545, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928984
Payload Length: 142
Payload Data Pointer: 0x17f709c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46419, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928984
Payload Length: 0
Payload Data Pointer: 0x17f711dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 48: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 13060, dport: 20480
Stream 48, port: 1073, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2573860490
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1073, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928988/2422865546
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10806, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928985
Payload Length: 1448
Payload Data Pointer: 0x17f7f7602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50626, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928985
Payload Length: 1448
Payload Data Pointer: 0x17fa956c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16983, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928985
Payload Length: 24
Payload Data Pointer: 0x17ef4bf42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2607414922
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45395, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 0
Payload Data Pointer: 0x17fbee902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45395, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 0
Payload Data Pointer: 0x17fbf04c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1073, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45395, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 0
Payload Data Pointer: 0x17fbf0e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56648, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2657746570/2331928988
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fbf174a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 50 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 50 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928988/2657746570
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44737, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 1448
Payload Data Pointer: 0x17fbf2082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47741, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 1448
Payload Data Pointer: 0x17efa4682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11023, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 1448
Payload Data Pointer: 0x17f046dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42234, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 904
Payload Data Pointer: 0x17f049c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45139, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 0
Payload Data Pointer: 0x17f0595c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 26996, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 0
Payload Data Pointer: 0x17f589e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38230, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928989
Payload Length: 166
Payload Data Pointer: 0x17f58b0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 13316, dport: 20480
Stream 49, port: 1074, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1074, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928989/2489974410
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 16244, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928988
Payload Length: 0
Payload Data Pointer: 0x17f5cc602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9526, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17f5f0cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49346, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17eff0b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15703, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2657746570/2331928989
Payload Length: 24
Payload Data Pointer: 0x17eff3082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44627, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17f4aec82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1074, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44627, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17f1e3102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55880, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2674523786/2331928989
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f1e3a4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 51 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 51 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46334, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17f1e4cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53268, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17f6a4982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49171, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 12
Payload Data Pointer: 0x17f6a6542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44371, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17f6a6e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 5829
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2657746570
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34641, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17f6a77c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23108, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 892
Payload Data Pointer: 0x17f6aa602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 892, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2340
my calculated merged len: 2340, recv_next: 8169, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5828
data_avail: 2340
MTP Receive Chain returned: 2340
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 26228, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17f6aaf42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37718, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 166
Payload Data Pointer: 0x17f6ab882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 13572, dport: 20480
Stream 50, port: 1075, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1075, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928989/2506751626
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 15476, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17f6ac1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9014, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17f6acb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48834, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17f6ad442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15191, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 24
Payload Data Pointer: 0x17fb02b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44371, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17fb046c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1075, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44371, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17fb05002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55624, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2674523786/2331928989
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fb0594a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
Stream 52 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 52 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43713, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17eed3202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46717, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17eef6642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9999, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 1448
Payload Data Pointer: 0x17fe3d682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41210, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 904
Payload Data Pointer: 0x17fe3dfc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44115, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17fe41742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 25972, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17fe42082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37462, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 166
Payload Data Pointer: 0x17fe429c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 13828, dport: 20480
Stream 51, port: 1076, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1076, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928989/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928989/2590637706
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 15220, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2674523786/2331928989
Payload Length: 0
Payload Data Pointer: 0x17fe45802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43859, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2691301002/2331928989
Payload Length: 0
Payload Data Pointer: 0x17fe46142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1076, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43859, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2691301002/2331928989
Payload Length: 0
Payload Data Pointer: 0x17fe46a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55112, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2691301002/2331928989
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fe473ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8502, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2691301002/2331928989
Window Scale: 7
Payload Length: 1448
Payload Data Pointer: 0x17f26ca82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48322, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2691301002/2331928989
Window Scale: 7
Payload Length: 1448
Payload Data Pointer: 0x17f26d3c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14679, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2691301002/2331928989
Window Scale: 7
Payload Length: 24
Payload Data Pointer: 0x17f26f8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
Stream 53 at state TCP_ST_LISTEN
In EPOLLIN
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
****************************
Stream 53 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928990/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928990/2691301002
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928990/2674523786
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928990/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928990/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 25204, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2691301002/2331928990
Payload Length: 0
Payload Data Pointer: 0x17f270202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928991/2691301002
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36346, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2691301002/2331928990
Payload Length: 1448
Payload Data Pointer: 0x17f270b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2297, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2691301002/2331928990
Payload Length: 1448
Payload Data Pointer: 0x17f922d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9231, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2691301002/2331928990
Payload Length: 1448
Payload Data Pointer: 0x17f9c4b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19987, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2691301002/2331928990
Payload Length: 880
Payload Data Pointer: 0x17f9c79c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5224
my calculated merged len: 5224, recv_next: 8145, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 2920
data_avail: 5224
MTP Receive Chain returned: 5224
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928991/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928991/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928991/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928991/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46907, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2708078218/2331928990
Payload Length: 24
Payload Data Pointer: 0x17ed78d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 14196, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2708078218/2331928990
Payload Length: 0
Payload Data Pointer: 0x17ed79fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 8144
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928991/2691301002
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6129, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2708078218/2331928991
Payload Length: 24
Payload Data Pointer: 0x17ed7a902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928991/2708078218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43193, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928991
Payload Length: 142
Payload Data Pointer: 0x17eda6802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42067, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928991
Payload Length: 0
Payload Data Pointer: 0x17edc5b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 52: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 14084, dport: 20480
Stream 52, port: 1077, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2708078218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1077, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928994/2657746570
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6710, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928991
Payload Length: 1448
Payload Data Pointer: 0x17f167ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46530, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928991
Payload Length: 1448
Payload Data Pointer: 0x17f168802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12887, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928991
Payload Length: 24
Payload Data Pointer: 0x17f169142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2708078218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41299, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 0
Payload Data Pointer: 0x17f16bf82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41299, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 0
Payload Data Pointer: 0x17f16c8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1077, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41299, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 0
Payload Data Pointer: 0x17f16d202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52552, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2758409866/2331928994
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f681e8a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 54 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 54 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27418, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 1448
Payload Data Pointer: 0x17f683a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22817, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 1448
Payload Data Pointer: 0x17f684382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6927, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 1448
Payload Data Pointer: 0x17f684cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17683, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 880
Payload Data Pointer: 0x17f685602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5224
my calculated merged len: 5224, recv_next: 8145, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41043, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 0
Payload Data Pointer: 0x17f685f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8145
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 2920
data_avail: 5224
MTP Receive Chain returned: 5224
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44859, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 24
Payload Data Pointer: 0x17f686882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 22900, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 0
Payload Data Pointer: 0x17f6871c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 8144
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34390, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 166
Payload Data Pointer: 0x17f687b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 14340, dport: 20480
Stream 53, port: 1078, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1078, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928994/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928994/2674523786
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 12148, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2758409866/2331928994
Payload Length: 0
Payload Data Pointer: 0x17f68d782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40787, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928994
Payload Length: 0
Payload Data Pointer: 0x17fe6d642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1078, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40787, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928994
Payload Length: 0
Payload Data Pointer: 0x17fe732c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52040, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2775187082/2331928994
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fbf580a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 55 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 55 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928995/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928995/2775187082
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5430, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928994
Payload Length: 1448
Payload Data Pointer: 0x17fbf6142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45250, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928994
Payload Length: 1448
Payload Data Pointer: 0x17f332602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11607, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928994
Payload Length: 24
Payload Data Pointer: 0x17f0164c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928995/2758409866
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928995/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928995/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 22132, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928995
Payload Length: 0
Payload Data Pointer: 0x17f0ad302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928995/2775187082
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33274, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928995
Payload Length: 1448
Payload Data Pointer: 0x17fdd7a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928996/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64760, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928995
Payload Length: 1448
Payload Data Pointer: 0x17fdda8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6159, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928995
Payload Length: 1448
Payload Data Pointer: 0x17fddb202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928995
Payload Length: 880
Payload Data Pointer: 0x17fddbb42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44091, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928995
Payload Length: 24
Payload Data Pointer: 0x17fdde982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 4416
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 11380, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928995
Payload Length: 0
Payload Data Pointer: 0x17fddf2c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928996/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928996/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928996/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928996/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3313, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2775187082/2331928996
Payload Length: 24
Payload Data Pointer: 0x17fddfc02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928996/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38995, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928996
Payload Length: 0
Payload Data Pointer: 0x17fde0542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8193
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928999/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3894, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928995
Payload Length: 1448
Payload Data Pointer: 0x17efbe6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43714, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928995
Payload Length: 1448
Payload Data Pointer: 0x17efc0282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10071, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928995
Payload Length: 24
Payload Data Pointer: 0x17efc0bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928999/2775187082
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928999/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928999/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39353, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 142
Payload Data Pointer: 0x17efc1502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 14596, dport: 20480
Stream 54, port: 1079, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928999/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1079, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928999/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331928999/2674523786
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39934, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 1448
Payload Data Pointer: 0x17efc1e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331928999/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46868, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 1448
Payload Data Pointer: 0x17f6e0242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42771, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 12
Payload Data Pointer: 0x17fa96002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1460
my calculated merged len: 1460, recv_next: 5829, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 4368
data_avail: 1460
MTP Receive Chain returned: 1460
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28241, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 1448
Payload Data Pointer: 0x17ef52502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16708, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 892
Payload Data Pointer: 0x17fb814c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 892, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2340
my calculated merged len: 2340, recv_next: 8169, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37971, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 0
Payload Data Pointer: 0x17fb81e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38227, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 0
Payload Data Pointer: 0x17fb82742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1079, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38227, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2842295946/2331928999
Payload Length: 0
Payload Data Pointer: 0x17fbae642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49480, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2842295946/2331928999
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fbcec4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31318, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2842295946/2331928999
Window Scale: 7
Payload Length: 166
Payload Data Pointer: 0x17fe01dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 5852
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 14852, dport: 20480
Stream 56 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 56 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
Stream 55, port: 1080, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1080, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929000/2842295946
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929000/2691301002
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37459, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2859073162/2331929000
Payload Length: 0
Payload Data Pointer: 0x17fdab242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1080, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37459, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2859073162/2331929000
Payload Length: 0
Payload Data Pointer: 0x17f0ba7c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 19316, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2859073162/2331929000
Payload Length: 0
Payload Data Pointer: 0x17f719f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48712, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2859073162/2331929000
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f71a88a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 57 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 57 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929001/2859073162
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929001/2859073162
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929001/2859073162
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 8308, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2875850378/2331929000
Payload Length: 0
Payload Data Pointer: 0x17f71b1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 18548, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2875850378/2331929001
Payload Length: 0
Payload Data Pointer: 0x17fca8242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929001/2875850378
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 7796, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2875850378/2331929001
Payload Length: 0
Payload Data Pointer: 0x17fca8b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 822, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929001
Payload Length: 1448
Payload Data Pointer: 0x17fcab082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2875850378
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40642, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929001
Payload Length: 1448
Payload Data Pointer: 0x17fcab9c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6999, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929001
Payload Length: 24
Payload Data Pointer: 0x17fcac302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 566, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929001
Payload Length: 1448
Payload Data Pointer: 0x17fcacc42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40386, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929001
Payload Length: 1448
Payload Data Pointer: 0x17fcad582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6743, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929001
Payload Length: 24
Payload Data Pointer: 0x17fcadec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2875850378
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37118, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 1448
Payload Data Pointer: 0x17fcae802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44052, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 1448
Payload Data Pointer: 0x17fcb3b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39955, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 12
Payload Data Pointer: 0x17ef35fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929004/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25425, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 1448
Payload Data Pointer: 0x17efb77c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30022, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 1058
Payload Data Pointer: 0x17efb8102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35155, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 0
Payload Data Pointer: 0x17efb8a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 56: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 15108, dport: 20480
Stream 56, port: 1081, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1081, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929005/2758409866
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27898, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 1448
Payload Data Pointer: 0x17f5073c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59384, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 1448
Payload Data Pointer: 0x17f528c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 783, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 1448
Payload Data Pointer: 0x17f2517c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31994, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2926182026/2331929004
Payload Length: 904
Payload Data Pointer: 0x17f1a8ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929005/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34643, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2942959242/2331929005
Payload Length: 0
Payload Data Pointer: 0x17f1ab902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34643, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2942959242/2331929005
Payload Length: 0
Payload Data Pointer: 0x17f1acb82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1081, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34643, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2942959242/2331929005
Payload Length: 0
Payload Data Pointer: 0x17ef1f702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45896, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2942959242/2331929005
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fc7794a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63216, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2942959242/2331929005
Window Scale: 7
Payload Length: 24
Payload Data Pointer: 0x17ef212c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
Stream 58 at state TCP_ST_LISTEN
In EPOLLIN
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
****************************
Stream 58 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929006/2942959242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929006/2942959242
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929006/2926182026
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 15732, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2959736458/2331929006
Payload Length: 0
Payload Data Pointer: 0x17f435f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929006/2959736458
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 4980, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 2959736458/2331929006
Payload Length: 0
Payload Data Pointer: 0x17ef20042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33977, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929006
Payload Length: 142
Payload Data Pointer: 0x17f766442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32851, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929006
Payload Length: 0
Payload Data Pointer: 0x17f766d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 57: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 15364, dport: 20480
Stream 57, port: 1082, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/2942959242
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1082, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929010/2775187082
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63029, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929006
Payload Length: 1448
Payload Data Pointer: 0x17fd82182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37314, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929006
Payload Length: 1448
Payload Data Pointer: 0x17fd88742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3671, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929006
Payload Length: 24
Payload Data Pointer: 0x17f76a502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/2959736458
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31827, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 0
Payload Data Pointer: 0x17f7a7982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31827, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 0
Payload Data Pointer: 0x17f7db0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1082, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31827, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 0
Payload Data Pointer: 0x17f7ddf02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43080, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3026845322/2331929010
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f7de84a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 59 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 59 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31169, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 1448
Payload Data Pointer: 0x17f7df182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34173, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 1448
Payload Data Pointer: 0x17f7dfac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62990, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 1448
Payload Data Pointer: 0x17f7e2902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28666, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 904
Payload Data Pointer: 0x17f7e3242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31571, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 0
Payload Data Pointer: 0x17f7e3b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929010/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 13428, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 0
Payload Data Pointer: 0x17f7e6082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24918, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 166
Payload Data Pointer: 0x17f7e69c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 15620, dport: 20480
Stream 58, port: 1083, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1083, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929011/2842295946
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 2676, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929010
Payload Length: 0
Payload Data Pointer: 0x17f7e7c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61493, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f308c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35778, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17ee9b0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2135, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929011
Payload Length: 24
Payload Data Pointer: 0x17eee8842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31315, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929011
Payload Length: 0
Payload Data Pointer: 0x17eec00c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1083, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31315, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3026845322/2331929011
Payload Length: 0
Payload Data Pointer: 0x17ee9d5c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42568, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3026845322/2331929011
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f8d27ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
Stream 60 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 60 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30401, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f8d3a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3026845322
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33405, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f8d4382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62222, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f8d4cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27898, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 904
Payload Data Pointer: 0x17f8d5602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f8d5f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 12660, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f8d6882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24150, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 166
Payload Data Pointer: 0x17f9aab42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 15876, dport: 20480
Stream 59, port: 1084, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1084, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929011/2859073162
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 1908, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f9ac702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60981, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f9ad042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35266, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f9ad982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1623, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 24
Payload Data Pointer: 0x17f9ae2c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f9aec02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1084, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f9b2cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42056, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3043622538/2331929011
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f04b7ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 61 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 61 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30145, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f142582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33149, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f142ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61966, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 1448
Payload Data Pointer: 0x17f144142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27642, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 904
Payload Data Pointer: 0x17f144a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30547, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f1453c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929011/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 12404, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3043622538/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f145d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929012/3043622538
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23638, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3060399754/2331929011
Payload Length: 166
Payload Data Pointer: 0x17fe71702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 16132, dport: 20480
Stream 60, port: 1085, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929012/3043622538
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1085, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929012/3060399754
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929012/2942959242
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 1396, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3060399754/2331929011
Payload Length: 0
Payload Data Pointer: 0x17f5ceb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30035, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3060399754/2331929012
Payload Length: 0
Payload Data Pointer: 0x17f5cf442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1085, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30035, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3060399754/2331929012
Payload Length: 0
Payload Data Pointer: 0x17f5cfd82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41288, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3060399754/2331929012
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f5d06ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 62 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 62 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929012/3060399754
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929012/3060399754
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 11636, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3060399754/2331929012
Payload Length: 0
Payload Data Pointer: 0x17f5d3e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929013/3060399754
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 884, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3060399754/2331929012
Payload Length: 0
Payload Data Pointer: 0x17f5d4782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59189, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929012
Payload Length: 1448
Payload Data Pointer: 0x17f5d6342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33474, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929012
Payload Length: 1448
Payload Data Pointer: 0x17f093c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65366, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929012
Payload Length: 24
Payload Data Pointer: 0x17f094542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3060399754
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58677, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929013
Payload Length: 1448
Payload Data Pointer: 0x17f097cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32962, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929013
Payload Length: 1448
Payload Data Pointer: 0x17f098602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64854, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929013
Payload Length: 24
Payload Data Pointer: 0x17f098f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3060399754
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27329, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 1448
Payload Data Pointer: 0x17f09bd82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30333, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 1448
Payload Data Pointer: 0x17f09c6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59150, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 1448
Payload Data Pointer: 0x17f09d002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24826, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 904
Payload Data Pointer: 0x17f09d942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20474, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 1448
Payload Data Pointer: 0x17f528302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51960, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 1448
Payload Data Pointer: 0x17f529582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58894, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 1448
Payload Data Pointer: 0x17f709302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24570, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 904
Payload Data Pointer: 0x17f529ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27731, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 0
Payload Data Pointer: 0x17f52a802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929016/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21078, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 166
Payload Data Pointer: 0x17fda2782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 16388, dport: 20480
Stream 61, port: 1086, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929017/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1086, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929017/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929017/3026845322
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56304, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3127508618/2331929016
Payload Length: 24
Payload Data Pointer: 0x17fad0642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929017/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27219, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3144285834/2331929017
Payload Length: 0
Payload Data Pointer: 0x17f1ece42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1086, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27219, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3144285834/2331929017
Payload Length: 0
Payload Data Pointer: 0x17fbdd382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38472, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3144285834/2331929017
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f9e6d4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 63 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 63 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929017/3144285834
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929017/3144285834
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 8820, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3144285834/2331929017
Payload Length: 0
Payload Data Pointer: 0x17f9e7682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929018/3144285834
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 63603, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3144285834/2331929017
Payload Length: 0
Payload Data Pointer: 0x17f9e7fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27065, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929017
Payload Length: 142
Payload Data Pointer: 0x17f9ea4c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25939, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929017
Payload Length: 0
Payload Data Pointer: 0x17f9eae02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 62: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 16644, dport: 20480
Stream 62, port: 1087, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3127508618
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1087, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929021/3026845322
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55861, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929018
Payload Length: 1448
Payload Data Pointer: 0x17f9ec082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30146, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929018
Payload Length: 1448
Payload Data Pointer: 0x17f717102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62038, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929018
Payload Length: 24
Payload Data Pointer: 0x17fe58002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3144285834
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 0
Payload Data Pointer: 0x17fe59bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 0
Payload Data Pointer: 0x17fe5a502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1087, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 0
Payload Data Pointer: 0x17fe5ae42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36168, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3211394698/2331929021
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fe5b78a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 64 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 64 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929021/3211394698
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11034, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 1448
Payload Data Pointer: 0x17fe5c0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6433, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 1448
Payload Data Pointer: 0x17fe5f842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56078, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 1448
Payload Data Pointer: 0x17fb36b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1299, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 880
Payload Data Pointer: 0x17fb38742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24659, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 0
Payload Data Pointer: 0x17fb39082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8145
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28475, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 24
Payload Data Pointer: 0x17fb399c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 6516, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3211394698/2331929021
Payload Length: 0
Payload Data Pointer: 0x17fb3c802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 8144
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17494, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 166
Payload Data Pointer: 0x17efa8742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 16900, dport: 20480
Stream 63, port: 1088, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3211394698
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1088, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929022/3043622538
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 61043, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929021
Payload Length: 0
Payload Data Pointer: 0x17efaa302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54325, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17efaac42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28610, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17efad142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60502, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 24
Payload Data Pointer: 0x17efada82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24147, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17efae3c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1088, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24147, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17efaed02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35400, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3228171914/2331929022
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17efaf64a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 65 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 65 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23489, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17efaff82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26493, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17efb08c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55310, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17f0164c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20986, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 904
Payload Data Pointer: 0x17ee08342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23891, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17f1fd142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 5748, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17f0ad302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17238, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 166
Payload Data Pointer: 0x17fa24b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 17156, dport: 20480
Stream 64, port: 1089, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1089, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929022/3060399754
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 60531, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17fa25442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54069, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17fa46382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28354, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17f6621c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60246, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 24
Payload Data Pointer: 0x17f663d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23891, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17f6646c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1089, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23891, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17f665942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35144, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3228171914/2331929022
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fcc478a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 66 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 66 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23233, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17f667502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26237, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17ef4acc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55054, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17fa97282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20730, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 904
Payload Data Pointer: 0x17fa97bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23635, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17fcef402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 5492, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17fcefd42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16982, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 166
Payload Data Pointer: 0x17fcf0682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 17412, dport: 20480
Stream 65, port: 1090, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1090, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929022/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929022/3144285834
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 60275, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17fcf4742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23635, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17fcf5082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1090, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23635, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3228171914/2331929022
Payload Length: 0
Payload Data Pointer: 0x17fcf59c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34888, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3228171914/2331929022
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fcf630a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 67 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 67 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3228171914
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53557, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17f76e5c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27842, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929022
Payload Length: 1448
Payload Data Pointer: 0x17f76ef02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59734, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929022
Payload Length: 24
Payload Data Pointer: 0x17f76f842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3228171914
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 4724, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929023
Payload Length: 0
Payload Data Pointer: 0x17f770ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3244949130
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15866, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929023
Payload Length: 1448
Payload Data Pointer: 0x17f771402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47352, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929023
Payload Length: 1448
Payload Data Pointer: 0x17f7b60c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54286, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929023
Payload Length: 1448
Payload Data Pointer: 0x17f7da782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19962, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929023
Payload Length: 904
Payload Data Pointer: 0x17fb8d702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929023/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 59507, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3244949130/2331929023
Payload Length: 0
Payload Data Pointer: 0x17fb8e042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51440, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3261726346/2331929023
Payload Length: 24
Payload Data Pointer: 0x17fb917c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929024/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22713, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929024
Payload Length: 142
Payload Data Pointer: 0x17fb92102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21587, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929024
Payload Length: 0
Payload Data Pointer: 0x17fb92a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 66: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 17668, dport: 20480
Stream 66, port: 1091, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3261726346
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1091, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929027/3211394698
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52021, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929023
Payload Length: 1448
Payload Data Pointer: 0x17fb95882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26306, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929023
Payload Length: 1448
Payload Data Pointer: 0x17fb961c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58198, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929023
Payload Length: 24
Payload Data Pointer: 0x17fb97d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3244949130
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20819, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 0
Payload Data Pointer: 0x17f504582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20819, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 0
Payload Data Pointer: 0x17eeb6382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1091, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20819, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 0
Payload Data Pointer: 0x17eeb7f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32072, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3312057994/2331929027
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17eeb888a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 68 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 68 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20161, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 1448
Payload Data Pointer: 0x17eeb91c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23165, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 1448
Payload Data Pointer: 0x17eeb9b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51982, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 1448
Payload Data Pointer: 0x17f547fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17658, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 904
Payload Data Pointer: 0x17eec1c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20563, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 0
Payload Data Pointer: 0x17efa0f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929027/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 2420, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 0
Payload Data Pointer: 0x17efa2182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3312057994
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13910, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 166
Payload Data Pointer: 0x17efa2ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 17924, dport: 20480
Stream 67, port: 1092, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1092, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929028/3228171914
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 57203, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929027
Payload Length: 0
Payload Data Pointer: 0x17efa3402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50485, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17efa3d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24770, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17efa4fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56662, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3312057994/2331929028
Payload Length: 24
Payload Data Pointer: 0x17f6b8d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20051, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 0
Payload Data Pointer: 0x17f088302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1092, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 20051, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 0
Payload Data Pointer: 0x17f089ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31304, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3328835210/2331929028
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f08a80a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 69 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 69 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19393, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17f08b142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3312057994
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22397, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17f08ba82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51214, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17f08c3c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16890, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 904
Payload Data Pointer: 0x17f090482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19795, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 0
Payload Data Pointer: 0x17f1022c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 1652, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 0
Payload Data Pointer: 0x17f103542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13142, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 166
Payload Data Pointer: 0x17f103e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 18180, dport: 20480
Stream 68, port: 1093, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1093, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929028/3228171914
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 56435, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 0
Payload Data Pointer: 0x17f1047c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49973, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17f107602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24258, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17f107f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56150, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 24
Payload Data Pointer: 0x17f108882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19795, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 0
Payload Data Pointer: 0x17fe3fb82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1093, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19795, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 0
Payload Data Pointer: 0x17fe44582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31048, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3328835210/2331929028
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fe4864a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 70 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 70 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929028/3328835210
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19137, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17fe473c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22141, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17f26ca82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50958, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 1448
Payload Data Pointer: 0x17f92efc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16634, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3328835210/2331929028
Payload Length: 904
Payload Data Pointer: 0x17f6724c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 1140, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929028
Payload Length: 0
Payload Data Pointer: 0x17f673742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19283, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929028
Payload Length: 0
Payload Data Pointer: 0x17f972a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3328835210
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3345612426
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3345612426
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12374, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929029
Payload Length: 166
Payload Data Pointer: 0x17ec4df02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 18436, dport: 20480
Stream 69, port: 1094, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3345612426
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1094, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3345612426
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929029/3228171914
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 55923, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929028
Payload Length: 0
Payload Data Pointer: 0x17fda4c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19027, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929029
Payload Length: 0
Payload Data Pointer: 0x17fe08cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1094, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19027, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929029
Payload Length: 0
Payload Data Pointer: 0x17fe28042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30280, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3345612426/2331929029
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fc2048a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 71 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 71 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3345612426
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3345612426
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 628, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929029
Payload Length: 0
Payload Data Pointer: 0x17fc20dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929029/3345612426
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 55411, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3345612426/2331929029
Payload Length: 0
Payload Data Pointer: 0x17fc21702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48181, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929029
Payload Length: 1448
Payload Data Pointer: 0x17fc24542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929033/3345612426
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22466, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929029
Payload Length: 1448
Payload Data Pointer: 0x17fc24e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54358, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929029
Payload Length: 24
Payload Data Pointer: 0x17fc257c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47925, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929029
Payload Length: 1448
Payload Data Pointer: 0x17ef6bc02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22210, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929029
Payload Length: 1448
Payload Data Pointer: 0x17ef6c542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54102, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929029
Payload Length: 24
Payload Data Pointer: 0x17ef6ea42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929033/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929033/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929033/3345612426
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929033/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929033/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 18686, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 1448
Payload Data Pointer: 0x17ef6f382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929033/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25620, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 1448
Payload Data Pointer: 0x17ef6fcc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21523, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 12
Payload Data Pointer: 0x17ef70602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1460
my calculated merged len: 1460, recv_next: 5829, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 4368
data_avail: 1460
MTP Receive Chain returned: 1460
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6993, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 1448
Payload Data Pointer: 0x17ef70f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11590, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 1058
Payload Data Pointer: 0x17ef71882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16723, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 0
Payload Data Pointer: 0x17ef721c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 70: TCP_ST_CLOSE_WAIT
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9466, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 1448
Payload Data Pointer: 0x17ef77502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40952, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 1448
Payload Data Pointer: 0x17f3edb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47886, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 1448
Payload Data Pointer: 0x17f3ef6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13562, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3412721290/2331929033
Payload Length: 904
Payload Data Pointer: 0x17f3f0002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 18692, dport: 20480
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
Stream 70, port: 1095, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1095, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929034/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929034/3312057994
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16211, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3429498506/2331929034
Payload Length: 0
Payload Data Pointer: 0x17f3f0942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16211, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3429498506/2331929034
Payload Length: 0
Payload Data Pointer: 0x17fe3dfc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1095, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16211, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3429498506/2331929034
Payload Length: 0
Payload Data Pointer: 0x17f9d2042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44784, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3429498506/2331929034
Payload Length: 24
Payload Data Pointer: 0x17f6ea8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27464, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3429498506/2331929034
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f6eb20a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
Stream 72 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 72 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929035/3412721290
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929035/3429498506
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929035/3429498506
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 62835, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3446275722/2331929035
Payload Length: 0
Payload Data Pointer: 0x17f6ee982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929035/3446275722
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 52083, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3446275722/2331929035
Payload Length: 0
Payload Data Pointer: 0x17f6ef2c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15801, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929035
Payload Length: 142
Payload Data Pointer: 0x17f6efc02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14675, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929035
Payload Length: 0
Payload Data Pointer: 0x17f6f2a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 71: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 18948, dport: 20480
Stream 71, port: 1096, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3429498506
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1096, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929038/3328835210
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44853, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929035
Payload Length: 1448
Payload Data Pointer: 0x17f6f3382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19138, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929035
Payload Length: 1448
Payload Data Pointer: 0x17f6f3cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51030, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929035
Payload Length: 24
Payload Data Pointer: 0x17f6f4f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3446275722
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13907, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 0
Payload Data Pointer: 0x17fdca5c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13907, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 0
Payload Data Pointer: 0x17fdcc182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1096, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13907, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 0
Payload Data Pointer: 0x17fdccac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25160, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3496607370/2331929038
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fdcd40a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 73 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 73 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13249, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 1448
Payload Data Pointer: 0x17fdcdd42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16253, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 1448
Payload Data Pointer: 0x17fdd14c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45070, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 1448
Payload Data Pointer: 0x17fdd1e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10746, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 904
Payload Data Pointer: 0x17fdd5582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13651, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 0
Payload Data Pointer: 0x17f7779c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929038/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 61043, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3496607370/2331929038
Payload Length: 0
Payload Data Pointer: 0x17f778c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929039/3496607370
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6742, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3513384586/2331929038
Payload Length: 166
Payload Data Pointer: 0x17fe03982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 19204, dport: 20480
Stream 72, port: 1097, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929039/3496607370
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1097, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929039/3513384586
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929039/3328835210
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 50035, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3513384586/2331929038
Payload Length: 0
Payload Data Pointer: 0x17f727402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13139, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3513384586/2331929039
Payload Length: 0
Payload Data Pointer: 0x17fe067c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1097, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13139, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3513384586/2331929039
Payload Length: 0
Payload Data Pointer: 0x17fe07102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24392, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3513384586/2331929039
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fe07a4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 74 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 74 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929040/3513384586
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929040/3513384586
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 60019, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3513384586/2331929040
Payload Length: 0
Payload Data Pointer: 0x17f0b0142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929040/3513384586
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 49011, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3530161802/2331929040
Payload Length: 0
Payload Data Pointer: 0x17fe576c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42293, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929039
Payload Length: 1448
Payload Data Pointer: 0x17fe5ca02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16578, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929039
Payload Length: 1448
Payload Data Pointer: 0x17ed393c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48470, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929039
Payload Length: 24
Payload Data Pointer: 0x17fbf7d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929043/3513384586
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929043/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929043/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41781, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929040
Payload Length: 1448
Payload Data Pointer: 0x17fddbb42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16066, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929040
Payload Length: 1448
Payload Data Pointer: 0x17fdde982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47958, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929040
Payload Length: 24
Payload Data Pointer: 0x17ed30902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929043/3530161802
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929043/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929043/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10433, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 1448
Payload Data Pointer: 0x17ed31b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929043/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13437, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 1448
Payload Data Pointer: 0x17ed32e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42254, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 1448
Payload Data Pointer: 0x17ec897c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7930, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 904
Payload Data Pointer: 0x17ed36582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3578, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 1448
Payload Data Pointer: 0x17ed3a642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35064, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 1448
Payload Data Pointer: 0x17ed3af82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41998, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 1448
Payload Data Pointer: 0x17ed6dd82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7674, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 904
Payload Data Pointer: 0x17ed6e6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10835, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 0
Payload Data Pointer: 0x17ed70bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4182, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929043
Payload Length: 166
Payload Data Pointer: 0x17ed71502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 19460, dport: 20480
Stream 73, port: 1098, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1098, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929044/3345612426
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39152, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3580493450/2331929044
Payload Length: 24
Payload Data Pointer: 0x17ed71e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929044/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10323, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3597270666/2331929044
Payload Length: 0
Payload Data Pointer: 0x17ed74c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1098, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10323, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3597270666/2331929044
Payload Length: 0
Payload Data Pointer: 0x17ed755c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 21576, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3597270666/2331929044
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f614a4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 75 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 75 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929045/3597270666
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929045/3597270666
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 56947, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3614047882/2331929045
Payload Length: 0
Payload Data Pointer: 0x17f615cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929045/3614047882
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 46195, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3614047882/2331929045
Payload Length: 0
Payload Data Pointer: 0x17f616602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9913, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929044
Payload Length: 142
Payload Data Pointer: 0x17f616f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8787, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929044
Payload Length: 0
Payload Data Pointer: 0x17f0242c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 74: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 19716, dport: 20480
Stream 74, port: 1099, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3580493450
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1099, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929049/3429498506
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38709, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929045
Payload Length: 1448
Payload Data Pointer: 0x17f4cd6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12994, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929045
Payload Length: 1448
Payload Data Pointer: 0x17f334b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44886, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929045
Payload Length: 24
Payload Data Pointer: 0x17f61d502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3614047882
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7507, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 0
Payload Data Pointer: 0x17f1fc802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7507, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 0
Payload Data Pointer: 0x17f651582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1099, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7507, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 0
Payload Data Pointer: 0x17f651ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 18760, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3681156746/2331929049
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f65280a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 76 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 76 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59161, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 1448
Payload Data Pointer: 0x17f978fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54560, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 1448
Payload Data Pointer: 0x17fb06bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38670, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 1448
Payload Data Pointer: 0x17f56aac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49426, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 880
Payload Data Pointer: 0x17f56b402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11067, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 24
Payload Data Pointer: 0x17f217ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 4416
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7251, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 0
Payload Data Pointer: 0x17ed065c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 54643, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 0
Payload Data Pointer: 0x17f21a902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 598, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 166
Payload Data Pointer: 0x17f21bb82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 19972, dport: 20480
Stream 75, port: 1100, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1100, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929049/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929049/3496607370
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 43891, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3681156746/2331929049
Payload Length: 0
Payload Data Pointer: 0x17f21c4c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6995, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3697933962/2331929049
Payload Length: 0
Payload Data Pointer: 0x17f21ce02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1100, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6995, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3697933962/2331929049
Payload Length: 0
Payload Data Pointer: 0x17fbd48c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 18248, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3697933962/2331929049
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fabcbca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 77 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 77 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929050/3697933962
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929050/3697933962
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 53875, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3697933962/2331929050
Payload Length: 0
Payload Data Pointer: 0x17fabe782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929050/3697933962
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 43123, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3697933962/2331929050
Payload Length: 0
Payload Data Pointer: 0x17fabf0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36149, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929049
Payload Length: 1448
Payload Data Pointer: 0x17fabfa02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3681156746
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10434, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929049
Payload Length: 1448
Payload Data Pointer: 0x17fac0342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42326, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929049
Payload Length: 24
Payload Data Pointer: 0x17fad6c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35637, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929050
Payload Length: 1448
Payload Data Pointer: 0x17fb6be82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9922, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929050
Payload Length: 1448
Payload Data Pointer: 0x17ef5f082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41814, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929050
Payload Length: 24
Payload Data Pointer: 0x17fc6c042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3697933962
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6398, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 1448
Payload Data Pointer: 0x17fc6c982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13332, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 1448
Payload Data Pointer: 0x17fc6e542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9235, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 12
Payload Data Pointer: 0x17ee05e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60240, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 1448
Payload Data Pointer: 0x17ef4a382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64837, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 1058
Payload Data Pointer: 0x17f330a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4435, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 0
Payload Data Pointer: 0x17fe02702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 76: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 20228, dport: 20480
Stream 76, port: 1101, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1101, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929054/3513384586
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62713, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 1448
Payload Data Pointer: 0x17eec0a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 28664, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 1448
Payload Data Pointer: 0x17eec1342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35598, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 1448
Payload Data Pointer: 0x17eec6682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1274, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 904
Payload Data Pointer: 0x17f230882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929054/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4435, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 0
Payload Data Pointer: 0x17eec7902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4435, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 0
Payload Data Pointer: 0x17f245ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1101, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4435, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 0
Payload Data Pointer: 0x17fd78442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15688, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3765042826/2331929054
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fd796ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 78 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 78 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929055/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929055/3765042826
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33008, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929054
Payload Length: 24
Payload Data Pointer: 0x17fd7a002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929055/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 51315, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929055
Payload Length: 0
Payload Data Pointer: 0x17fd7a942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929055/3765042826
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 40563, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3765042826/2331929055
Payload Length: 0
Payload Data Pointer: 0x17fd7b282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4025, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929055
Payload Length: 142
Payload Data Pointer: 0x17fd7e0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2899, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929055
Payload Length: 0
Payload Data Pointer: 0x17fd7ea02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 77: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 20484, dport: 20480
Stream 77, port: 1102, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1102, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929058/3597270666
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33077, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929055
Payload Length: 1448
Payload Data Pointer: 0x17f0b38c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7362, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929055
Payload Length: 1448
Payload Data Pointer: 0x17f218d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39254, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929055
Payload Length: 24
Payload Data Pointer: 0x17f219682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3765042826
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2131, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 0
Payload Data Pointer: 0x17f23f902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2131, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 0
Payload Data Pointer: 0x17f3185c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1102, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2131, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 0
Payload Data Pointer: 0x17f318f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13384, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3832151690/2331929058
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f31fe0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 79 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 79 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53785, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 1448
Payload Data Pointer: 0x17f6d1b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49184, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 1448
Payload Data Pointer: 0x17f71e942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33294, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 1448
Payload Data Pointer: 0x17f02e002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44050, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 880
Payload Data Pointer: 0x17f722a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929058/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5691, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 24
Payload Data Pointer: 0x17ed8f602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1875, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 0
Payload Data Pointer: 0x17f765b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 49267, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 0
Payload Data Pointer: 0x17f5e78c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60757, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3832151690/2331929058
Payload Length: 166
Payload Data Pointer: 0x17f5e9482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 20740, dport: 20480
Stream 78, port: 1103, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1103, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3832151690
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3832151690
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929059/3681156746
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1363, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3848928906/2331929059
Payload Length: 0
Payload Data Pointer: 0x17f5e9dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1103, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1363, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3848928906/2331929059
Payload Length: 0
Payload Data Pointer: 0x17f5ea702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 38259, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3848928906/2331929058
Payload Length: 0
Payload Data Pointer: 0x17f5eb042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12616, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3848928906/2331929059
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f5eb98a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 80 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 80 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3848928906
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3848928906
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 48499, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3848928906/2331929059
Payload Length: 0
Payload Data Pointer: 0x17fbdf882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929059/3848928906
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 37747, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3848928906/2331929059
Payload Length: 0
Payload Data Pointer: 0x17fbe0b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30517, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929059
Payload Length: 1448
Payload Data Pointer: 0x17fbe1442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4802, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929059
Payload Length: 1448
Payload Data Pointer: 0x17fbe3942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36694, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929059
Payload Length: 24
Payload Data Pointer: 0x17fbe4282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3848928906
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30261, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929059
Payload Length: 1448
Payload Data Pointer: 0x17fbe4bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4546, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929059
Payload Length: 1448
Payload Data Pointer: 0x17fbe5502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36438, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929059
Payload Length: 24
Payload Data Pointer: 0x17fbe5e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3848928906
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 1022, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 1448
Payload Data Pointer: 0x17fbe6782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7956, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 1448
Payload Data Pointer: 0x17fbe70c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3859, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 12
Payload Data Pointer: 0x17fa94442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929063/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54864, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 1448
Payload Data Pointer: 0x17ef47542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 5284
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4356
my calculated merged len: 4356, recv_next: 7277, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43331, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 892
Payload Data Pointer: 0x17f4b3682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 892, last_rcvd_seq: 8169, ctx->rwnd_size: 3836
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64594, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 0
Payload Data Pointer: 0x17f4b3fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 29, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57337, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 1448
Payload Data Pointer: 0x17f4b4902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 5272
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4368
my calculated merged len: 4368, recv_next: 4369, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23288, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 1448
Payload Data Pointer: 0x17f19e442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 3824
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5816
my calculated merged len: 5816, recv_next: 5817, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30222, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 1448
Payload Data Pointer: 0x17f525e02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 2376
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 7264
my calculated merged len: 7264, recv_next: 7265, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61433, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 904
Payload Data Pointer: 0x17f0ff482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 928
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 8168
my calculated merged len: 8168, recv_next: 8169, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 29, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 18, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 7, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 0, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57941, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3916037770/2331929063
Payload Length: 166
Payload Data Pointer: 0x17f0ffdc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 2944
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5414
my calculated merged len: 5414, recv_next: 8335, last_flushed: 2920
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 21, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929064/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64082, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3932814986/2331929064
Payload Length: 0
Payload Data Pointer: 0x17f105102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 0
data_avail: 8168
MTP Receive Chain returned: 8168
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 2920
data_avail: 5415
MTP Receive Chain returned: 5415
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 20996, dport: 20480
Stream 79, port: 1104, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929067/3697933962
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929067/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1104, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929067/3932814986
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8264, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3983146634/2331929067
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f8d7b0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 81 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 81 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929067/3983146634
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929067/3983146634
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25584, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3983146634/2331929067
Payload Length: 24
Payload Data Pointer: 0x17f9abdc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1104, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62546, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3983146634/2331929067
Payload Length: 0
Payload Data Pointer: 0x17f1091c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929067/3916037770
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 44147, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3983146634/2331929067
Payload Length: 0
Payload Data Pointer: 0x17f8d8d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929067/3983146634
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 33395, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3983146634/2331929067
Payload Length: 0
Payload Data Pointer: 0x17f9aec02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63160, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929067
Payload Length: 142
Payload Data Pointer: 0x17f9b2cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62034, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929067
Payload Length: 0
Payload Data Pointer: 0x17f57d2c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 80: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 21252, dport: 20480
Stream 80, port: 1105, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3983146634
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1105, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929068/3765042826
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26677, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929067
Payload Length: 1448
Payload Data Pointer: 0x17f57ee82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 962, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929067
Payload Length: 1448
Payload Data Pointer: 0x17f57f7c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32854, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929067
Payload Length: 24
Payload Data Pointer: 0x17f580102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3983146634
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61778, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 0
Payload Data Pointer: 0x17f580a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61778, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 0
Payload Data Pointer: 0x17fab9d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1105, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61778, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 0
Payload Data Pointer: 0x17fafce82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7496, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3999923850/2331929068
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17faffcca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 82 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 82 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61120, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 1448
Payload Data Pointer: 0x17fb11242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64124, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 1448
Payload Data Pointer: 0x17eea5742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27406, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 1448
Payload Data Pointer: 0x17eea6082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58617, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 904
Payload Data Pointer: 0x17fdfca82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61522, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 0
Payload Data Pointer: 0x17eef53c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929068/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 43379, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 0
Payload Data Pointer: 0x17fd74cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54869, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 166
Payload Data Pointer: 0x17fd75602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 21508, dport: 20480
Stream 81, port: 1106, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1106, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929069/3832151690
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 32627, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929068
Payload Length: 0
Payload Data Pointer: 0x17fd75f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25909, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17f1047c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 194, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17fd7bbc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32086, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929069
Payload Length: 24
Payload Data Pointer: 0x17f092042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61266, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929069
Payload Length: 0
Payload Data Pointer: 0x17f30b102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1106, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61266, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 3999923850/2331929069
Payload Length: 0
Payload Data Pointer: 0x17f1c5942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6984, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 3999923850/2331929069
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f1c628a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 83 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 83 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47129, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17f1c6bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/3999923850
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42528, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17f1c9a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26638, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17f1ca342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37394, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 880
Payload Data Pointer: 0x17f1cac82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60754, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 0
Payload Data Pointer: 0x17f1cb5c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8145
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64570, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 24
Payload Data Pointer: 0x17f1cbf02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 42611, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 0
Payload Data Pointer: 0x17f1cffc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54101, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 166
Payload Data Pointer: 0x17f9c8302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 21764, dport: 20480
Stream 82, port: 1107, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1107, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929069/3848928906
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60754, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 0
Payload Data Pointer: 0x17fa5b9c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1107, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60754, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 0
Payload Data Pointer: 0x17fa5c302
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 31859, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 0
Payload Data Pointer: 0x17fa5cc42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25397, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17edcca82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65217, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17edf1a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31574, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 24
Payload Data Pointer: 0x17f0bccc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6472, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 4016701066/2331929069
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f0bd60a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
Stream 84 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 84 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929069/4016701066
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46873, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17f0c0d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42272, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17f0c16c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5817, cur_stream->mtp->last_flushed: 2920
data_avail: 2896
MTP Receive Chain returned: 2896
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26382, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 1448
Payload Data Pointer: 0x17f0c2002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7265, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37138, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4016701066/2331929069
Payload Length: 880
Payload Data Pointer: 0x17f0c4e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2328
my calculated merged len: 2328, recv_next: 8145, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64058, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929069
Payload Length: 24
Payload Data Pointer: 0x17f0c5782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 5864
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2352
my calculated merged len: 2352, recv_next: 8169, last_flushed: 5816
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 60242, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929069
Payload Length: 0
Payload Data Pointer: 0x17f0c60c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 42099, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929069
Payload Length: 0
Payload Data Pointer: 0x17f0c6a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5816
data_avail: 2352
MTP Receive Chain returned: 2352
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4016701066
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4033478282
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4033478282
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53333, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929070
Payload Length: 166
Payload Data Pointer: 0x17f50a202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 22020, dport: 20480
Stream 83, port: 1108, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4033478282
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1108, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929070/4033478282
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929070/3983146634
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 31347, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929069
Payload Length: 0
Payload Data Pointer: 0x17f50bdc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59986, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929070
Payload Length: 0
Payload Data Pointer: 0x17f50c702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1108, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59986, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929070
Payload Length: 0
Payload Data Pointer: 0x17f50d042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 5704, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 4033478282/2331929070
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f50d98a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 85 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 85 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929071/4033478282
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929071/4033478282
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 41331, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929071
Payload Length: 0
Payload Data Pointer: 0x17f50e2c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929071/4033478282
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 30579, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4033478282/2331929071
Payload Length: 0
Payload Data Pointer: 0x17f50ec02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23349, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929070
Payload Length: 1448
Payload Data Pointer: 0x17f513602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929075/4033478282
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 63169, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929070
Payload Length: 1448
Payload Data Pointer: 0x17fab8b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29526, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929070
Payload Length: 24
Payload Data Pointer: 0x17fb7af02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22837, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929071
Payload Length: 1448
Payload Data Pointer: 0x17fb7c182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62657, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929071
Payload Length: 1448
Payload Data Pointer: 0x17fb7cac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29014, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929071
Payload Length: 24
Payload Data Pointer: 0x17ec57c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929075/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929075/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929075/4033478282
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929075/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929075/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59133, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 1448
Payload Data Pointer: 0x17efb9382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 532, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 1448
Payload Data Pointer: 0x17fcd3802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61970, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 12
Payload Data Pointer: 0x17fcd53c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47440, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 1448
Payload Data Pointer: 0x17fcd5d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52037, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 1058
Payload Data Pointer: 0x17fcd6642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57170, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 0
Payload Data Pointer: 0x17fcd6f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 84: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 22276, dport: 20480
Stream 84, port: 1109, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1109, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929076/3999923850
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49913, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 1448
Payload Data Pointer: 0x17fcd78c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 15864, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 1448
Payload Data Pointer: 0x17f19c882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22798, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 1448
Payload Data Pointer: 0x17ed38a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54009, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4117364362/2331929075
Payload Length: 904
Payload Data Pointer: 0x17f1bc542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929076/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56658, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4134141578/2331929076
Payload Length: 0
Payload Data Pointer: 0x17fdd5ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56658, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4134141578/2331929076
Payload Length: 0
Payload Data Pointer: 0x17fe23642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1109, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56658, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4134141578/2331929076
Payload Length: 0
Payload Data Pointer: 0x17fe56442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2376, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 4134141578/2331929076
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17eff964a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 86 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 86 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929077/4134141578
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929077/4134141578
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19696, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4134141578/2331929076
Payload Length: 24
Payload Data Pointer: 0x17eff9f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929077/4117364362
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 37747, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4150918794/2331929077
Payload Length: 0
Payload Data Pointer: 0x17effa8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929077/4150918794
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 26995, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4150918794/2331929077
Payload Length: 0
Payload Data Pointer: 0x17effb202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55992, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929077
Payload Length: 142
Payload Data Pointer: 0x17effe982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 54866, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929077
Payload Length: 0
Payload Data Pointer: 0x17efff2c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 85: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 22532, dport: 20480
Stream 85, port: 1110, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4134141578
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1110, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929081/3999923850
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19509, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929077
Payload Length: 1448
Payload Data Pointer: 0x17efffc02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59329, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929077
Payload Length: 1448
Payload Data Pointer: 0x17f000542
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 25686, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929077
Payload Length: 24
Payload Data Pointer: 0x17f002a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4150918794
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53842, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 0
Payload Data Pointer: 0x17f004602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53842, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 0
Payload Data Pointer: 0x17f021dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1110, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53842, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 0
Payload Data Pointer: 0x17ed6cb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65095, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 4218027658/2331929081
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ed6d44a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 87 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 87 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39961, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 1448
Payload Data Pointer: 0x17ed72782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35360, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 1448
Payload Data Pointer: 0x17efb4042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19470, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 1448
Payload Data Pointer: 0x17fcc1002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30226, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 880
Payload Data Pointer: 0x17ed76842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 57402, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 24
Payload Data Pointer: 0x17f0a6d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 4416
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53586, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 0
Payload Data Pointer: 0x17ef4ed82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 35443, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 0
Payload Data Pointer: 0x17ef4f6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929081/4218027658
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46933, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 166
Payload Data Pointer: 0x17f2c3602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 22788, dport: 20480
Stream 86, port: 1111, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929082/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1111, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929082/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929082/4016701066
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 24691, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4218027658/2331929081
Payload Length: 0
Payload Data Pointer: 0x17f2c51c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53074, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4234804874/2331929082
Payload Length: 0
Payload Data Pointer: 0x17f2c5b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1111, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53074, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4234804874/2331929082
Payload Length: 0
Payload Data Pointer: 0x17f2c6442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64327, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 4234804874/2331929082
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f2c928a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 88 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 88 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929082/4234804874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929082/4234804874
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 34675, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4234804874/2331929082
Payload Length: 0
Payload Data Pointer: 0x17f2c9bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929082/4234804874
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 23923, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 4234804874/2331929082
Payload Length: 0
Payload Data Pointer: 0x17f2ca502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16949, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929081
Payload Length: 1448
Payload Data Pointer: 0x17f2cae42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 1449, cur_stream->mtp->last_flushed: 0
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929086/4218027658
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56769, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929081
Payload Length: 1448
Payload Data Pointer: 0x17f782982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 2897, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 23126, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929081
Payload Length: 24
Payload Data Pointer: 0x17f7832c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1472
my calculated merged len: 1472, recv_next: 2921, last_flushed: 1448
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16437, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929082
Payload Length: 1448
Payload Data Pointer: 0x17f783c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 56257, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929082
Payload Length: 1448
Payload Data Pointer: 0x17f784e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 22614, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929082
Payload Length: 24
Payload Data Pointer: 0x17f7af1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 1448
data_avail: 1472
MTP Receive Chain returned: 1472
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929086/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929086/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929086/4234804874
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929086/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929086/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52733, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 1448
Payload Data Pointer: 0x17efb9cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59667, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 1448
Payload Data Pointer: 0x17f9ccd02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55570, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 12
Payload Data Pointer: 0x17f9cd642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41040, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 1448
Payload Data Pointer: 0x17f9cdf82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 45637, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 1058
Payload Data Pointer: 0x17f9d0dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 1058, last_rcvd_seq: 8335, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2506
my calculated merged len: 2506, recv_next: 8335, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50770, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 0
Payload Data Pointer: 0x17f9d1702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 87: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 5828
data_avail: 2507
MTP Receive Chain returned: 2507
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 23044, dport: 20480
Stream 87, port: 1112, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 44, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1112, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929087/4033478282
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43513, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 1448
Payload Data Pointer: 0x17f9d2982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9464, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 1448
Payload Data Pointer: 0x17ed58742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16398, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 1448
Payload Data Pointer: 0x17ed59082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47609, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 7011978/2331929086
Payload Length: 904
Payload Data Pointer: 0x17ed599c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929087/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50258, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 23789194/2331929087
Payload Length: 0
Payload Data Pointer: 0x17ee22cc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50258, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 23789194/2331929087
Payload Length: 0
Payload Data Pointer: 0x17ee23602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1112, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50258, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 23789194/2331929087
Payload Length: 0
Payload Data Pointer: 0x17ee23f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61511, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 23789194/2331929087
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ee26d8a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13296, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 23789194/2331929087
Window Scale: 7
Payload Length: 24
Payload Data Pointer: 0x17ee276c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
Stream 89 at state TCP_ST_LISTEN
In EPOLLIN
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
****************************
Stream 89 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929088/23789194
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929088/23789194
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929088/7011978
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 31347, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 40566410/2331929088
Payload Length: 0
Payload Data Pointer: 0x17ee28002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929088/40566410
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 20595, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 40566410/2331929088
Payload Length: 0
Payload Data Pointer: 0x17ee28942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49848, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929088
Payload Length: 142
Payload Data Pointer: 0x17ed37802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48722, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929088
Payload Length: 0
Payload Data Pointer: 0x17f546d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 88: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 23300, dport: 20480
Stream 88, port: 1113, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/23789194
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1113, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929091/4134141578
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13365, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929088
Payload Length: 1448
Payload Data Pointer: 0x17f852b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53185, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929088
Payload Length: 1448
Payload Data Pointer: 0x17f855082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19542, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929088
Payload Length: 24
Payload Data Pointer: 0x17f8559c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/40566410
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47954, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f857582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47954, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f8784c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1113, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47954, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f043f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 59207, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 90898058/2331929091
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f0448ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 90 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 90 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34073, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 1448
Payload Data Pointer: 0x17f6b9fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29472, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 1448
Payload Data Pointer: 0x17fe6fb42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13582, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 1448
Payload Data Pointer: 0x17f1ad4c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24338, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 880
Payload Data Pointer: 0x17f04f882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 51514, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 24
Payload Data Pointer: 0x17f0501c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47698, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f051442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 29555, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f051d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41045, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 166
Payload Data Pointer: 0x17f55df42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 23556, dport: 20480
Stream 89, port: 1114, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1114, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929091/90898058
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929091/4218027658
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47698, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f55fb02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1114, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47698, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f560442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 18803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 90898058/2331929091
Payload Length: 0
Payload Data Pointer: 0x17f560d82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58951, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 90898058/2331929091
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f5616ca
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 91 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 91 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929092/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929092/90898058
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 28787, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 107675274/2331929092
Payload Length: 0
Payload Data Pointer: 0x17f564e42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929092/107675274
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 18035, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 107675274/2331929092
Payload Length: 0
Payload Data Pointer: 0x17f565782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 11061, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929091
Payload Length: 1448
Payload Data Pointer: 0x17f5fcf02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50881, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929091
Payload Length: 1448
Payload Data Pointer: 0x17f5fe182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 17238, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929091
Payload Length: 24
Payload Data Pointer: 0x17f5feac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/90898058
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10549, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929092
Payload Length: 1448
Payload Data Pointer: 0x17f5ff402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50369, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929092
Payload Length: 1448
Payload Data Pointer: 0x17f5ffd42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16726, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929092
Payload Length: 24
Payload Data Pointer: 0x17f602b82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/107675274
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44480, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 1448
Payload Data Pointer: 0x17f6034c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47484, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 1448
Payload Data Pointer: 0x17f62d802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10766, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 1448
Payload Data Pointer: 0x17f62ea82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41977, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 904
Payload Data Pointer: 0x17f62f3c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37625, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 1448
Payload Data Pointer: 0x17f62fd02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3576, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 1448
Payload Data Pointer: 0x17f630642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10510, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 1448
Payload Data Pointer: 0x17f633dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41721, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 904
Payload Data Pointer: 0x17f634702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44882, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 0
Payload Data Pointer: 0x17f635042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38229, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 166
Payload Data Pointer: 0x17f65bc02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 23812, dport: 20480
Stream 90, port: 1115, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1115, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929096/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929096/4234804874
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7920, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 174784138/2331929096
Payload Length: 24
Payload Data Pointer: 0x17f741442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929097/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44626, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 191561354/2331929096
Payload Length: 0
Payload Data Pointer: 0x17f743942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1115, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44626, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 191561354/2331929096
Payload Length: 0
Payload Data Pointer: 0x17f763f42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 55879, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 191561354/2331929096
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f0ab74a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 92 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 92 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929097/191561354
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929097/191561354
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 25971, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 191561354/2331929097
Payload Length: 0
Payload Data Pointer: 0x17f536a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929098/191561354
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 15219, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 191561354/2331929097
Payload Length: 0
Payload Data Pointer: 0x17f537382
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44216, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929097
Payload Length: 142
Payload Data Pointer: 0x17ed505c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 43090, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929097
Payload Length: 0
Payload Data Pointer: 0x17ed50f02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 91: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 24068, dport: 20480
Stream 91, port: 1116, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/174784138
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1116, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929101/23789194
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7477, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929098
Payload Length: 1448
Payload Data Pointer: 0x17ed53402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 47297, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929098
Payload Length: 1448
Payload Data Pointer: 0x17ed53d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 13654, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929098
Payload Length: 24
Payload Data Pointer: 0x17ed54682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/191561354
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42066, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 0
Payload Data Pointer: 0x17ed54fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42066, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 0
Payload Data Pointer: 0x17ed55902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1116, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42066, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 0
Payload Data Pointer: 0x17fbe3002
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 53319, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 258670218/2331929101
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f2d390a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 93 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 93 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41408, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 1448
Payload Data Pointer: 0x17f324802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44412, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 1448
Payload Data Pointer: 0x17f325a82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 7694, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 1448
Payload Data Pointer: 0x17f3263c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38905, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 904
Payload Data Pointer: 0x17f31a182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41810, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 0
Payload Data Pointer: 0x17f87bc42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 23667, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 0
Payload Data Pointer: 0x17fad5982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35157, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 166
Payload Data Pointer: 0x17f914642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 24324, dport: 20480
Stream 92, port: 1117, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1117, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929101/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929101/90898058
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 12915, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 0
Payload Data Pointer: 0x17efa2182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41810, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 258670218/2331929101
Payload Length: 0
Payload Data Pointer: 0x17fad87c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1117, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41554, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929101
Payload Length: 0
Payload Data Pointer: 0x17fad9102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 52807, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 275447434/2331929101
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17fad9a4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6197, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 275447434/2331929101
Window Scale: 7
Payload Length: 1448
Payload Data Pointer: 0x17fdb0582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46017, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 275447434/2331929101
Window Scale: 7
Payload Length: 1448
Payload Data Pointer: 0x17efeb842
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 12374, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 275447434/2331929101
Window Scale: 7
Payload Length: 24
Payload Data Pointer: 0x17efed402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
Stream 94 at state TCP_ST_LISTEN
In EPOLLIN
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
****************************
Stream 94 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929102/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929102/275447434
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929102/258670218
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929102/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929102/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 22899, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929102
Payload Length: 0
Payload Data Pointer: 0x17ec62c02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929103/275447434
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34041, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929102
Payload Length: 1448
Payload Data Pointer: 0x17ec622c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65527, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929102
Payload Length: 1448
Payload Data Pointer: 0x17f1efc82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6926, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929102
Payload Length: 1448
Payload Data Pointer: 0x17f037402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38137, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929102
Payload Length: 904
Payload Data Pointer: 0x17f037d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929103/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929103/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929103/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929103/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 12147, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929102
Payload Length: 0
Payload Data Pointer: 0x17f038682
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4080, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 275447434/2331929103
Payload Length: 24
Payload Data Pointer: 0x17f038fc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929103/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40888, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929103
Payload Length: 142
Payload Data Pointer: 0x17fc44202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39762, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929103
Payload Length: 0
Payload Data Pointer: 0x17fc44b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 93: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 24580, dport: 20480
Stream 93, port: 1118, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1118, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929106/90898058
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4405, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929103
Payload Length: 1448
Payload Data Pointer: 0x17fc45482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 44225, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929103
Payload Length: 1448
Payload Data Pointer: 0x17fc45dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 10582, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929103
Payload Length: 24
Payload Data Pointer: 0x17fc482c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/275447434
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38994, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 0
Payload Data Pointer: 0x17fc5a182
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38994, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 0
Payload Data Pointer: 0x17fc9e502
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1118, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38994, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 0
Payload Data Pointer: 0x17ee104c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 50247, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 342556298/2331929106
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ee10e0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 95 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 95 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929106/342556298
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38336, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 1448
Payload Data Pointer: 0x17ee14582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41340, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 1448
Payload Data Pointer: 0x17ee14ec2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4622, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 1448
Payload Data Pointer: 0x17ee15802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35833, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 904
Payload Data Pointer: 0x17ee18642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38738, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 0
Payload Data Pointer: 0x17ee18f82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 20595, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 342556298/2331929106
Payload Length: 0
Payload Data Pointer: 0x17ee198c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/342556298
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31573, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 166
Payload Data Pointer: 0x17ee1a202
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 24836, dport: 20480
Stream 94, port: 1119, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/342556298
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1119, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929107/191561354
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 9587, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929106
Payload Length: 0
Payload Data Pointer: 0x17f3219c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2869, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17f765b02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42689, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17f5e78c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 9046, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 24
Payload Data Pointer: 0x17f5e9482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38226, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f2d0ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1119, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38226, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f2d1402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49479, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 359333514/2331929107
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f2d1d4a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 96 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 96 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 24345, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17f2d6742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 19744, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17f6f7442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 3854, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17f0bccc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 14610, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 880
Payload Data Pointer: 0x17f0bd602
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 880, last_rcvd_seq: 8145, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3776
my calculated merged len: 3776, recv_next: 8145, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37970, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17fc20dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8145
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8145, cur_stream->mtp->last_flushed: 4368
data_avail: 3776
MTP Receive Chain returned: 3776
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 8145
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 8145, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41786, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 24
Payload Data Pointer: 0x17fcb6042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8145, ev_payloadlen: 24, last_rcvd_seq: 8169, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8169, last_flushed: 8144
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 19827, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17ef54a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31317, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 166
Payload Data Pointer: 0x17ed70282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8168
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 190
my calculated merged len: 190, recv_next: 8335, last_flushed: 8144
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8144
data_avail: 191
MTP Receive Chain returned: 191
mtcp_recv called: sockid 1, len 8192, flags 0
MTP Receive Chain called: sockid 1, len 8192
MTP Receive Chain returned: 0
Socket 1 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 25092, dport: 20480
Stream 95, port: 1120, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1120, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929107/258670218
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37970, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17ed755c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1120, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37970, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f614a42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 9075, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17fa5f142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2613, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17fa5fa82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42433, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17fa603c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8790, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 24
Payload Data Pointer: 0x17ef67b42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 49223, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 359333514/2331929107
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ef6848a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
Stream 97 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 97 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 64
Payload Data Pointer: 0x17eb4a980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 39677, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17ef68dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46611, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17f011ac2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 42514, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 12
Payload Data Pointer: 0x17f012402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 12, last_rcvd_seq: 5829, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2908
my calculated merged len: 2908, recv_next: 5829, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37714, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f012d42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 5829
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 5829, cur_stream->mtp->last_flushed: 2920
data_avail: 2908
MTP Receive Chain returned: 2908
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 5829
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 5829, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27984, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 1448
Payload Data Pointer: 0x17f755802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5829, ev_payloadlen: 1448, last_rcvd_seq: 7277, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 7277, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 7277, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 16451, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 892
Payload Data Pointer: 0x17f017742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7277, ev_payloadlen: 892, last_rcvd_seq: 8169, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2340
my calculated merged len: 2340, recv_next: 8169, last_flushed: 5828
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 19571, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f018082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 5828
data_avail: 2340
MTP Receive Chain returned: 2340
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 7277
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 45, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 42
Payload Data Pointer: 0x17eb4a9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31061, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 166
Payload Data Pointer: 0x17f0189c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 2, len 8192, flags 0
MTP Receive Chain called: sockid 2, len 8192
MTP Receive Chain returned: 0
Socket 2 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 25348, dport: 20480
Stream 96, port: 1121, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1121, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929107/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929107/275447434
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 8819, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 359333514/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f9fdf42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37458, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 376110730/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f9fe882
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1121, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37458, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 376110730/2331929107
Payload Length: 0
Payload Data Pointer: 0x17f9ff1c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 48711, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 376110730/2331929107
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17f9ffb0a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2101, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 376110730/2331929107
Window Scale: 7
Payload Length: 1448
Payload Data Pointer: 0x17fa00442
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 41921, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 376110730/2331929107
Window Scale: 7
Payload Length: 1448
Payload Data Pointer: 0x17fa3a142
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 8278, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 376110730/2331929107
Window Scale: 7
Payload Length: 24
Payload Data Pointer: 0x17ec872c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
Stream 98 at state TCP_ST_LISTEN
In EPOLLIN
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
****************************
Stream 98 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929108/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929108/376110730
Payload Length: 64
Payload Data Pointer: 0x17eb4c9c0
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929108/359333514
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929108/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929108/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 18803, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 376110730/2331929108
Payload Length: 0
Payload Data Pointer: 0x17f551d02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929109/376110730
Payload Length: 42
Payload Data Pointer: 0x17eb4ca00
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 29945, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 376110730/2331929108
Payload Length: 1448
Payload Data Pointer: 0x17f552642
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 61431, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 376110730/2331929108
Payload Length: 1448
Payload Data Pointer: 0x17f555dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 5817, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 2830, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 376110730/2331929108
Payload Length: 1448
Payload Data Pointer: 0x17f556702
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 4344
my calculated merged len: 4344, recv_next: 7265, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34041, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 376110730/2331929108
Payload Length: 904
Payload Data Pointer: 0x17f557042
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 3848
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 5248
my calculated merged len: 5248, recv_next: 8169, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 2920
data_avail: 5248
MTP Receive Chain returned: 5248
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929109/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929109/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 30, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929109/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 23, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929109/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 7795, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 392887946/2331929108
Payload Length: 0
Payload Data Pointer: 0x17f559e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65263, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 392887946/2331929109
Payload Length: 24
Payload Data Pointer: 0x17f55a7c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929109/376110730
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 36792, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929109
Payload Length: 142
Payload Data Pointer: 0x17f55b102
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 35666, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929109
Payload Length: 0
Payload Data Pointer: 0x17f55ba42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 97: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 3, len 8192, flags 0
MTP Receive Chain called: sockid 3, len 8192
MTP Receive Chain returned: 0
Socket 3 File download complete!
socktype: 1
Created stream with saddr: 100665098, daddr: 83887882, sport: 25604, dport: 20480
Stream 97, port: 1122, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/392887946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1122, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 0, Ack Seq: 0
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=0, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 2331929112/342556298
Window Scale: 7
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 309, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929109
Payload Length: 1448
Payload Data Pointer: 0x17f31e242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 40129, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929109
Payload Length: 1448
Payload Data Pointer: 0x17ef60c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 6486, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929109
Payload Length: 24
Payload Data Pointer: 0x17ef61582
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/392887946
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34898, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 0
Payload Data Pointer: 0x17f986dc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34898, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 0
Payload Data Pointer: 0x17f68d782
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1122, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34898, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 0
Payload Data Pointer: 0x17ef62802
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
parsed mss: 1460
parsed wscale: 7
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 0, Ack Seq: 1
Header Length: 40
Flags: FIN=0, SYN=1, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 46151, Urg Ptr: 0
Options:
MSS: 1460
Timestamp: 443219594/2331929112
Window Scale: 7
Payload Length: 0
Payload Data Pointer: 0x17ef8af8a
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
Stream 99 at state TCP_ST_LISTEN
In EPOLLIN
****************************
Stream 99 in send ep
send_ep cwnd_size: 2920, last_rwnd_remote: 64, send_next: 1, send_una: 1
send_ep bytes to send: 64, data_rest: 106, window_avail: 64
send_ep bytes to send: 64
got bp
index: 3
Seq in send_ep: 1
send next: 65
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 1, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/443219594
Payload Length: 64
Payload Data Pointer: 0x17eb48940
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34240, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 1448
Payload Data Pointer: 0x17ef9e0c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929112/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 37244, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 1448
Payload Data Pointer: 0x17fd9e6c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 526, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 1448
Payload Data Pointer: 0x17f7ef482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31737, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 904
Payload Data Pointer: 0x17f7f3e82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34642, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 0
Payload Data Pointer: 0x17fe66742
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8169
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 1, Ack Seq: 65
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 16499, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 0
Payload Data Pointer: 0x17eccc8c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
ack_net_ep: cwnd: 2920, rwnd: 64
ack_net_ep: window_end_exclusive: 129, send_next: 65, send_una: 1
ack_net_ep: window_avail: 64, bytes to send: 42
got bp
index: 4
Seq: 65
----------------------------- fin_ack_ep: 65
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 27989, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 166
Payload Data Pointer: 0x17f202482
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 166, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 166
my calculated merged len: 166, recv_next: 8335, last_flushed: 8168
data_net_ep: raising read event
data_net_ep: final_seq_remote: 8335, recv_next: 8335
data_net_ep: raising read event for fin
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 6
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8168
data_avail: 167
MTP Receive Chain returned: 167
mtcp_recv called: sockid 4, len 8192, flags 0
MTP Receive Chain called: sockid 4, len 8192
MTP Receive Chain returned: 0
Socket 4 File download complete!
socktype: 1
Stream 98, port: 1123, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 65, Ack Seq: 1
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 42
Payload Data Pointer: 0x17eb48980
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1123, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 5747, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929112
Payload Length: 0
Payload Data Pointer: 0x17efe4942
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34386, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929113
Payload Length: 0
Payload Data Pointer: 0x17efe5282
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1123, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 34386, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 443219594/2331929113
Payload Length: 0
Payload Data Pointer: 0x17efe5bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 1, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 64308, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 1448
Payload Data Pointer: 0x17efe8a02
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1, ev_payloadlen: 1448, last_rcvd_seq: 1449, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 1449, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 1449, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 38593, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 1448
Payload Data Pointer: 0x17efe9342
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 1449, ev_payloadlen: 1448, last_rcvd_seq: 2897, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 2897, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 2897, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 4950, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 24
Payload Data Pointer: 0x17efe9c82
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2897, ev_payloadlen: 24, last_rcvd_seq: 2921, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2920
my calculated merged len: 2920, recv_next: 2921, last_flushed: 0
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 2921, cur_stream->mtp->last_flushed: 0
data_avail: 2920
MTP Receive Chain returned: 2920
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 1449
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/443219594
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 2897
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 2921
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 2921, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 26873, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 1448
Payload Data Pointer: 0x17f4fc402
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 2921, ev_payloadlen: 1448, last_rcvd_seq: 4369, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 4369, last_flushed: 2920
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 4369, cur_stream->mtp->last_flushed: 2920
data_avail: 1448
MTP Receive Chain returned: 1448
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 4369
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 4369, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 58359, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 1448
Payload Data Pointer: 0x17f4fdfc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 4369, ev_payloadlen: 1448, last_rcvd_seq: 5817, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 1448
my calculated merged len: 1448, recv_next: 5817, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 5817, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 65293, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 1448
Payload Data Pointer: 0x17f4fe902
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 5817, ev_payloadlen: 1448, last_rcvd_seq: 7265, ctx->rwnd_size: 6744
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 2896
my calculated merged len: 2896, recv_next: 7265, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 7265, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 30969, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 904
Payload Data Pointer: 0x17f4ff242
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 7265, ev_payloadlen: 904, last_rcvd_seq: 8169, ctx->rwnd_size: 5296
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 3800
my calculated merged len: 3800, recv_next: 8169, last_flushed: 4368
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8169, cur_stream->mtp->last_flushed: 4368
data_avail: 3800
MTP Receive Chain returned: 3800
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 5817
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 52, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 7265
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 41, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 8169
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 34, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 8169, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 62703, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 459996810/2331929113
Payload Length: 24
Payload Data Pointer: 0x17f502082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8169, ev_payloadlen: 24, last_rcvd_seq: 8193, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 24
my calculated merged len: 24, recv_next: 8193, last_flushed: 8168
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8193, cur_stream->mtp->last_flushed: 8168
data_avail: 24
MTP Receive Chain returned: 24
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: -1
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 8193
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 63, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929113/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 8193, Ack Seq: 107
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 33720, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 543882890/2331929113
Payload Length: 142
Payload Data Pointer: 0x17f5029c2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
data_net_ep: ev_seq: 8193, ev_payloadlen: 142, last_rcvd_seq: 8335, ctx->rwnd_size: 8192
MTP_SEQ_GT(last_rcvd_seq, ctx->recv_next + ctx->rwnd_size, ctx->recv_init_seq): 0
data_net_ep: MTP_SEQ_LT(last_rcvd_seq, ctx->recv_next, ctx->recv_init_seq): 0
Grabbing lock in data_net_ep
recv buffer merged len: 142
my calculated merged len: 142, recv_next: 8335, last_flushed: 8192
data_net_ep: raising read event
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 32594, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 543882890/2331929113
Payload Length: 0
Payload Data Pointer: 0x17f503c42
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 5
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8335
Stream 99: TCP_ST_CLOSE_WAIT
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
receive_ep: ev_data_sizse: 8192, cur_stream->mtp->recv_next: 8336, cur_stream->mtp->last_flushed: 8192
data_avail: 143
MTP Receive Chain returned: 143
mtcp_recv called: sockid 5, len 8192, flags 0
MTP Receive Chain called: sockid 5, len 8192
MTP Receive Chain returned: 0
Socket 5 File download complete!
socktype: 1
[CPU 0] Completed 100 connections, errors: 0 incompletes: 0
Stream 99, port: 1124, Calling close
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 8335
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929118/459996810
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 62, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929118/543882890
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Sending MTP packet:
*************** MTP BP Header ******************
Source: 1124, Dest: 80, Seq: 107, Ack Seq: 8336
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 0, Urg Ptr: 0
Options:
Timestamp: 2331929118/543882890
Payload Length: 0
Payload Data Pointer: (nil)
Needs Segmentation: No, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31314, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 543882890/2331929118
Payload Length: 0
Payload Data Pointer: 0x17f1a1bc2
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 8335, Ack Seq: 107
Header Length: 32
Flags: FIN=1, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31314, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 543882890/2331929118
Payload Length: 0
Payload Data Pointer: 0x17fe42082
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 107
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 107, final_seq: 107, fin_sent:1
going into MTP FIN
ev_seq: 8335, ev_payload_len: 0, recv_next: 8336
---------------------------------
Received MTP packet:
*************** MTP BP Header ******************
Source: 80, Dest: 1124, Seq: 8335, Ack Seq: 108
Header Length: 32
Flags: FIN=0, SYN=0, RST=0, PSH=0, ACK=1, URG=0
Window: 64, Checksum: 31314, Urg Ptr: 0
Options:
MSS: 0
Timestamp: 543882890/2331929118
Payload Length: 0
Payload Data Pointer: 0x17f6ee982
Needs Segmentation: Yes, Seg Size: 0, Seg Rule Group ID: 0
*********************************************
THIS CASE
----------------------------- fin_ack_ep: 108
cur_stream->mtp->state: 10
in fin_ack_ep: ev_ack_seq: 108, final_seq: 107, fin_sent:1
fin_ack_ep: state changed to CLOSED
